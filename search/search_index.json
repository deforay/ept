{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"ePT Documentation","text":"<p>Welcome to the ePT (e-Proficiency Testing) documentation. This index provides an overview of the project and links to detailed documentation.</p>"},{"location":"#project-overview","title":"Project Overview","text":"<p>ePT is an open-source proficiency testing system for laboratory quality assurance. It enables organizations to:</p> <ul> <li>Create and manage PT shipments across multiple test schemes</li> <li>Enroll participants (laboratories) and track their responses</li> <li>Evaluate results against reference data with configurable scoring</li> <li>Generate reports (Excel, PDF) for analysis and certification</li> </ul>"},{"location":"#supported-test-schemes","title":"Supported Test Schemes","text":"Scheme Description DTS HIV Serology (Dried Tube Specimen) - Rapid HIV testing with multiple algorithms VL HIV Viral Load - Quantitative viral load testing with Z-score analysis EID Early Infant Diagnosis - PCR-based infant HIV testing TB Tuberculosis - Molecular (GeneXpert) and microscopy testing Recency HIV Recency - RTRI-based recent infection testing COVID-19 COVID-19 testing - Multi-platform PCR testing DBS Dried Blood Spot - EIA and Western Blot testing Custom Tests User-configurable test types with dynamic fields"},{"location":"#technology-stack","title":"Technology Stack","text":"<ul> <li>Framework: Zend Framework 1 (PHP 8.4)</li> <li>Database: MySQL 8+</li> <li>Web Server: Apache 2 with mod_rewrite</li> <li>Background Jobs: Crunz scheduler</li> <li>Reports: PhpSpreadsheet (Excel), TCPDF (PDF)</li> <li>Email: Symfony Mailer</li> </ul>"},{"location":"#documentation-index","title":"Documentation Index","text":""},{"location":"#training-curriculum","title":"Training Curriculum","text":"Document Audience Duration Training Overview All \u2014 Part 1: System Setup &amp; Participants Admin ~10 min Part 2: PT Survey &amp; Shipment Management Admin ~10 min Part 3: Participant \u2014 Results &amp; Reports Participant ~5\u201310 min Part 4: Evaluation, Reports &amp; Finalization Admin ~10 min Exercise: DTS HIV Serology All ~20\u201330 min"},{"location":"#architecture-guides","title":"Architecture &amp; Guides","text":"Document Description Architecture Guide High-level system architecture, request lifecycle, security, modules, and infrastructure Scheme Architecture Test scheme organization, data flow, evaluation logic, and report generation Admin Module Guide Admin panel workflows, controllers, AJAX patterns, and form validation Translation Guide Internationalization and adding new languages"},{"location":"#quick-links","title":"Quick Links","text":""},{"location":"#for-developers","title":"For Developers","text":"<ul> <li>Request Lifecycle - How requests flow through the system</li> <li>Service Layer - Business logic organization</li> <li>Database Migrations - How to manage schema changes</li> <li>Adding a New Scheme - Step-by-step guide</li> </ul>"},{"location":"#for-administrators","title":"For Administrators","text":"<ul> <li>Scheduled Jobs - Background task configuration</li> <li>Email Infrastructure - Email queue and configuration</li> <li>Shipment Lifecycle - How shipments progress through states</li> </ul>"},{"location":"#for-maintainers","title":"For Maintainers","text":"<ul> <li>Security - Authentication, authorization, CSRF protection</li> <li>Error Handling - Logging and error management</li> <li>Scoring Formula - How participant scores are calculated</li> </ul>"},{"location":"#directory-structure-high-level","title":"Directory Structure (High-Level)","text":"<pre><code>ept/\n\u251c\u2500\u2500 application/\n\u2502   \u251c\u2500\u2500 configs/          # Application configuration\n\u2502   \u251c\u2500\u2500 controllers/      # Default module controllers\n\u2502   \u251c\u2500\u2500 models/           # Database models and business logic\n\u2502   \u251c\u2500\u2500 modules/          # Admin, API, Reports modules\n\u2502   \u251c\u2500\u2500 services/         # Business logic layer\n\u2502   \u2514\u2500\u2500 views/            # View templates\n\u2502\n\u251c\u2500\u2500 database/\n\u2502   \u251c\u2500\u2500 migrations/       # SQL migration files\n\u2502   \u2514\u2500\u2500 schema/           # Database schema definitions\n\u2502\n\u251c\u2500\u2500 docs/                 # Documentation (you are here)\n\u2502\n\u251c\u2500\u2500 library/Pt/           # Custom library code\n\u2502\n\u251c\u2500\u2500 public/               # Web root\n\u2502   \u251c\u2500\u2500 index.php         # Entry point\n\u2502   \u2514\u2500\u2500 assets/           # Static files (CSS, JS, images)\n\u2502\n\u251c\u2500\u2500 scheduled-jobs/       # Crunz background tasks\n\u2502\n\u2514\u2500\u2500 vendor/               # Composer dependencies\n</code></pre>"},{"location":"#getting-started","title":"Getting Started","text":""},{"location":"#prerequisites","title":"Prerequisites","text":"<ul> <li>Apache 2 with mod_rewrite</li> <li>MySQL 8+</li> <li>PHP 8.4</li> <li>Composer</li> </ul>"},{"location":"#installation","title":"Installation","text":"<p>See the main README for installation instructions.</p>"},{"location":"#configuration","title":"Configuration","text":"<p>Key configuration files:</p> File Purpose <code>application/configs/application.ini</code> Database, sessions, modules <code>application/configs/config.ini</code> Domain-specific settings, thresholds <code>constants.php</code> Global paths and version"},{"location":"#contributing","title":"Contributing","text":"<p>When adding new features or modifying existing ones:</p> <ol> <li>Read the architecture docs - Understand existing patterns before making changes</li> <li>Follow the service layer pattern - Keep controllers thin, put logic in services</li> <li>Use existing utilities - Check <code>library/Pt/Commons/</code> and <code>application/services/</code></li> <li>Add migrations - Database changes go in <code>database/migrations/</code></li> <li>Update documentation - Keep these docs current with your changes</li> </ol>"},{"location":"#support","title":"Support","text":"<p>For questions or issues, contact: amit (at) deforay (dot) com</p> <p>GitHub: deforay/ept</p>"},{"location":"ARCHITECTURE/","title":"ePT Code Architecture (PHP 8.4 + Zend Framework 1)","text":"<p>This document describes the high-level structure and execution flow of the ePT codebase.</p>"},{"location":"ARCHITECTURE/#high-level-overview","title":"High-level overview","text":"<ul> <li>Zend Framework 1 (ZF1) MVC app with default module plus <code>admin</code>, <code>api</code>, and <code>reports</code> modules.</li> <li>Controllers orchestrate requests and delegate to service classes (<code>application/services</code>).</li> <li>Service classes use ZF1 <code>Zend_Db_Table</code> models (<code>application/models/DbTable</code>) and other models.</li> <li>Views live under <code>application/views</code> and module-specific <code>application/modules/*/views</code>, with layouts under <code>application/layouts</code>.</li> <li>Background work runs via Crunz scheduled jobs in <code>scheduled-jobs/</code>.</li> <li>Multi-scheme support: DTS, VL, EID, TB, Recency, and Generic test types.</li> </ul>"},{"location":"ARCHITECTURE/#entry-points","title":"Entry points","text":"<ul> <li>Web: <code>public/index.php</code></li> <li>CLI bootstrap (used by scripts/jobs): <code>cli-bootstrap.php</code></li> <li>Scheduled tasks: <code>scheduled-jobs/ScheduledTasks.php</code> (Crunz)</li> <li>CLI utilities: <code>bin/*.php</code>, <code>db-tools.php</code>, <code>runner/</code></li> </ul>"},{"location":"ARCHITECTURE/#request-lifecycle-web","title":"Request lifecycle (web)","text":"<pre><code>flowchart TD\n  A[HTTP Request] --&gt; B[public/index.php]\n  B --&gt; C[Zend_Application]\n  C --&gt; D[Bootstrap.php]\n  D --&gt; E[Front Controller + Router]\n  E --&gt; F[Pt_Plugins_PreSetter]\n  F --&gt; G[Controller Action]\n  G --&gt; H[Application_Service_*]\n  H --&gt; I[Model DbTable + Zend_Db]\n  I --&gt; J[(MySQL)]\n  G --&gt; K[View + Layout]\n  K --&gt; L[HTTP Response]\n</code></pre>"},{"location":"ARCHITECTURE/#bootstrap-responsibilities","title":"Bootstrap responsibilities","text":"<ul> <li>Loads configuration from <code>application/configs/application.ini</code>.</li> <li>Starts session, sets timezone, initializes CSRF token.</li> <li>Configures routes for captcha and downloads.</li> <li>Sets a default metadata cache for <code>Zend_Db_Table</code>.</li> <li>Initializes translation (<code>application/languages</code>).</li> </ul>"},{"location":"ARCHITECTURE/#front-controller-plugin","title":"Front controller plugin","text":"<ul> <li><code>library/Pt/Plugins/PreSetter.php</code> enforces:</li> <li>CSRF checks on requests.</li> <li>Authentication rules for default vs admin/report modules.</li> <li>Layout switching for admin/report contexts.</li> </ul>"},{"location":"ARCHITECTURE/#security","title":"Security","text":""},{"location":"ARCHITECTURE/#csrf-protection","title":"CSRF protection","text":"<p><code>Application_Service_SecurityService</code> handles CSRF tokens:</p> <ul> <li>Generates 64-character tokens via <code>bin2hex(random_bytes(32))</code>.</li> <li>Stored in session namespace <code>csrf</code>.</li> <li>Validates POST/PUT/PATCH/DELETE requests using timing-safe <code>hash_equals()</code>.</li> <li>Token source: <code>X-CSRF-Token</code> header or <code>csrf_token</code> POST parameter.</li> <li>Exempt: CLI requests, XHR, API module, error controller.</li> </ul>"},{"location":"ARCHITECTURE/#authentication","title":"Authentication","text":"<p>Session-based authentication using <code>Zend_Session_Namespace</code>:</p> <ul> <li>Data managers (participants): <code>datamanagers</code> session namespace.</li> <li>Administrators: <code>administrators</code> session namespace.</li> <li>Features:</li> <li>Email verification workflow.</li> <li>Login attempt ban system (configurable temp/permanent bans).</li> <li>Force password reset capability.</li> <li>CAPTCHA verification before login.</li> <li>Session tracking via <code>UserLoginHistory</code>.</li> </ul>"},{"location":"ARCHITECTURE/#authorization","title":"Authorization","text":"<p><code>Pt_Plugins_PreSetter</code> enforces access control:</p> <ul> <li>Frontend access requires <code>datamanagers</code> session.</li> <li>Admin module access requires <code>administrators</code> session.</li> <li>Admins can access specific frontend URIs: <code>/dts/response</code>, <code>/eid/response</code>, <code>/vl/response</code>, <code>/tb/response</code>, <code>/recency/response</code>, <code>/generic-test/response</code>, <code>/tb/assay-formats</code>.</li> <li>Unauthenticated users redirected to login.</li> <li>Disabled for: error controller, auth controller, captcha, shipment-form.</li> </ul>"},{"location":"ARCHITECTURE/#input-validation","title":"Input validation","text":"<ul> <li><code>Pt_Commons_MiscUtility</code>: Sanitization utilities.</li> <li><code>sanitizeFilename()</code>: Regex-based filename sanitization.</li> <li><code>toUtf8()</code>: Recursive UTF-8 encoding conversion.</li> <li><code>cleanString()</code>: Removes invisible Unicode characters, BOM, ZWSP.</li> <li><code>Application_Service_Common::parseRecipients()</code>: Email validation with comma/semicolon splitting.</li> <li>Email validation via <code>filter_var(FILTER_VALIDATE_EMAIL)</code>.</li> </ul>"},{"location":"ARCHITECTURE/#modules-and-controllers","title":"Modules and controllers","text":"<ul> <li>Default module controllers live in <code>application/controllers</code>.</li> <li>Module controllers live in <code>application/modules/{admin,api,reports}/controllers</code>.</li> <li>Common patterns:</li> <li>Controllers call service layer classes like <code>Application_Service_Common</code>, <code>Application_Service_Shipments</code>.</li> <li>Services call <code>Application_Model_DbTable_*</code> for persistence.</li> </ul>"},{"location":"ARCHITECTURE/#service-layer","title":"Service layer","text":"<ul> <li>Located in <code>application/services/</code>.</li> <li>Contains business logic for:</li> <li>Shipments, participants, evaluations, reports, security, etc.</li> <li>Encourages reuse across web, API, and scheduled jobs.</li> </ul>"},{"location":"ARCHITECTURE/#data-access","title":"Data access","text":"<ul> <li><code>application/models/DbTable/*</code> uses <code>Zend_Db_Table_Abstract</code> conventions.</li> <li>Configured via <code>resources.db.*</code> in <code>application/configs/application.ini</code>.</li> <li>Database schema and utilities live under <code>database/</code> and <code>db-tools.php</code>.</li> </ul>"},{"location":"ARCHITECTURE/#error-handling-and-logging","title":"Error handling and logging","text":""},{"location":"ARCHITECTURE/#error-controller","title":"Error controller","text":"<p><code>application/controllers/ErrorController.php</code> handles application errors:</p> <ul> <li>404 errors: <code>EXCEPTION_NO_ROUTE</code>, <code>EXCEPTION_NO_CONTROLLER</code>, <code>EXCEPTION_NO_ACTION</code>.</li> <li>500 errors: All other application exceptions.</li> <li>Logs errors with priority levels (NOTICE for 404, CRIT for 500).</li> <li>Conditionally displays stack traces based on <code>displayExceptions</code> config.</li> </ul>"},{"location":"ARCHITECTURE/#logging","title":"Logging","text":"<p><code>library/Pt/Commons/LoggerUtility.php</code> provides application logging via Monolog:</p> <ul> <li>Rotating file handler with 30-day retention.</li> <li>Log file: <code>/logs/logfile.log</code> with date format <code>Y-m-d</code>.</li> <li>Fallback to stderr if logs directory not writable.</li> <li>Static methods: <code>logError()</code> and <code>logInfo()</code>.</li> <li>Auto-captures caller file/line information via backtrace.</li> </ul>"},{"location":"ARCHITECTURE/#caching","title":"Caching","text":""},{"location":"ARCHITECTURE/#file-based-cache-default","title":"File-based cache (default)","text":"<p>Configured in <code>application/Bootstrap.php</code>:</p> <ul> <li>Backend: File-based (<code>application/cache/</code>).</li> <li>Lifetime: Extended (7200000000 seconds).</li> <li>Used for <code>Zend_Db_Table</code> metadata caching.</li> </ul>"},{"location":"ARCHITECTURE/#redis-cache-optional","title":"Redis cache (optional)","text":"<p><code>library/Pt/Cache/Backend/Redis.php</code> provides Redis caching:</p> <ul> <li>Custom <code>Zend_Cache</code> backend implementation.</li> <li>Tag-based caching support.</li> <li>TTL management via Redis expiration.</li> <li>Transaction support (<code>multi()</code>/<code>exec()</code>).</li> <li>Key prefixing for namespace isolation.</li> </ul>"},{"location":"ARCHITECTURE/#configuration","title":"Configuration","text":"<ul> <li><code>application/configs/application.ini</code>:</li> <li>ZF1 bootstrap settings, DB connection, module paths, mail settings.</li> <li><code>application/configs/config.ini</code>:</li> <li>Domain-specific defaults (evaluation thresholds, site content, locale).</li> <li><code>constants.php</code>:</li> <li>Global paths and version.</li> </ul>"},{"location":"ARCHITECTURE/#scheduled-jobs","title":"Scheduled jobs","text":"<p>Crunz executes task definitions in <code>scheduled-jobs/ScheduledTasks.php</code>.</p> <pre><code>flowchart TD\n  A[Cron: vendor/bin/crunz schedule:run] --&gt; B[Crunz Schedule]\n  B --&gt; C[scheduled-jobs/*.php]\n  C --&gt; D[cli-bootstrap.php]\n  D --&gt; E[Application_Service_*]\n  E --&gt; F[DbTable + Zend_Db]\n  E --&gt; G[Filesystem outputs]\n  E --&gt; H[Email notifications]\n</code></pre>"},{"location":"ARCHITECTURE/#job-schedule","title":"Job schedule","text":"Job Frequency Purpose <code>generate-shipment-reports.php</code> Every minute Report generation <code>execute-job-queue.php</code> Every minute Job queue processor <code>send-emails.php</code> Every minute Email queue processor <code>reset-stale-jobs.php</code> Every 15 min Stale job recovery <code>db-tools backup</code> Daily 00:45 Database backup <code>db-tools purge-binlogs</code> Daily 04:05 MySQL binary log cleanup"},{"location":"ARCHITECTURE/#job-queue","title":"Job queue","text":"<p><code>Application_Model_DbTable_ScheduledJobs</code> manages the <code>scheduled_jobs</code> table:</p> <ul> <li>Statuses: <code>pending</code> \u2192 <code>processing</code> \u2192 <code>completed</code>.</li> <li>Jobs scheduled via: <code>scheduleCertificationGeneration()</code>, <code>scheduleEvaluation()</code>.</li> <li><code>execute-job-queue.php</code> fetches pending jobs (FIFO) and executes via shell.</li> </ul>"},{"location":"ARCHITECTURE/#email-infrastructure","title":"Email infrastructure","text":""},{"location":"ARCHITECTURE/#email-queue","title":"Email queue","text":"<p><code>Application_Model_DbTable_TempMail</code> manages the <code>temp_mail</code> table:</p> <ul> <li>Statuses: <code>pending</code> \u2192 <code>picked-to-process</code> \u2192 <code>sent</code>/<code>failed</code>/<code>not-sent</code>.</li> <li>Failure types: <code>smtp-auth</code>, <code>connectivity</code>, <code>bad-recipient</code>, <code>rate-limit</code>, <code>content</code>, <code>other</code>.</li> </ul>"},{"location":"ARCHITECTURE/#email-sending","title":"Email sending","text":"<p><code>scheduled-jobs/send-emails.php</code> processes the email queue:</p> <ul> <li>Uses Symfony Mailer (replaces Zend_Mail).</li> <li>Batches recipients (To + Cc + Bcc) up to 100 per email.</li> <li>File-based lock (<code>/tmp/ept_mail_cron.lock</code>) with 10-minute TTL.</li> <li>Attachments: 15MB per file limit, 22MB total per message.</li> </ul>"},{"location":"ARCHITECTURE/#configuration_1","title":"Configuration","text":"<p>Mail settings stored in <code>system_config.mail</code> (JSON):</p> <pre><code>{\n  \"host\": \"smtp.example.com\",\n  \"port\": 587,\n  \"username\": \"...\",\n  \"password\": \"...\",\n  \"ssl\": \"tls\",\n  \"fromEmail\": \"...\",\n  \"fromName\": \"ePT System\"\n}\n</code></pre>"},{"location":"ARCHITECTURE/#health-monitoring","title":"Health monitoring","text":"<p><code>Application_Service_Common::getEmailHealthStatus()</code> tracks failure rates:</p> <ul> <li>Configurable window (default 7 days).</li> <li>Severity levels: ok, warning (&gt;5%), critical (&gt;15%).</li> </ul>"},{"location":"ARCHITECTURE/#api-module","title":"API module","text":""},{"location":"ARCHITECTURE/#structure","title":"Structure","text":"<p>API controllers in <code>application/modules/api/controllers/</code>:</p> <ul> <li><code>LoginController</code>: Authentication, password reset.</li> <li><code>ShipmentsController</code>: Shipment data endpoints.</li> <li><code>ParticipantController</code>: Participant data endpoints.</li> <li><code>InitController</code>: Initialization/setup.</li> <li><code>AggregatedInsightsController</code>: Analytics/reporting.</li> </ul>"},{"location":"ARCHITECTURE/#response-format","title":"Response format","text":"<ul> <li>JSON-only responses (no XML).</li> <li>Request parsing: <code>json_decode(file_get_contents('php://input'))</code>.</li> <li>Response: <code>json_encode($result, JSON_PRETTY_PRINT)</code>.</li> </ul>"},{"location":"ARCHITECTURE/#api-services","title":"API services","text":"<p><code>Application_Service_ApiServices</code> provides:</p> <ul> <li>Authentication via <code>authToken</code>.</li> <li>Data marshaling for all test schemes (DTS, VL, EID, TB, Recency, Generic).</li> <li>Reference data: test kits, possible results, not-tested reasons.</li> </ul>"},{"location":"ARCHITECTURE/#database-migrations","title":"Database migrations","text":""},{"location":"ARCHITECTURE/#migration-system","title":"Migration system","text":"<p><code>bin/migrate.php</code> handles database migrations:</p> <ul> <li>SQL-based migrations in <code>database/migrations/</code>.</li> <li>Version tracking via <code>system_config.app_version</code>.</li> <li>Uses <code>version_compare()</code> to run only newer migrations.</li> <li>Idempotent DDL helper functions.</li> <li>Flags: <code>--dry-run</code>, <code>-y</code> (auto-continue), <code>-q</code> (quiet).</li> </ul>"},{"location":"ARCHITECTURE/#run-once-scripts","title":"Run-once scripts","text":"<p><code>bin/run-once.php</code> executes one-time setup scripts:</p> <ul> <li>Tracking table: <code>run_once_scripts</code>.</li> <li>Idempotent execution prevention.</li> </ul>"},{"location":"ARCHITECTURE/#library-and-helpers","title":"Library and helpers","text":"<ul> <li>Custom libraries live under <code>library/Pt</code>.</li> <li>Notable areas:</li> <li><code>Pt/Plugins</code> (request-level hooks)</li> <li><code>Pt/Helper/View</code> (view helpers)</li> <li><code>Pt/Reports</code> (report generation helpers)</li> <li><code>Pt/Commons</code> (utilities: logging, sanitization)</li> <li><code>Pt/Cache</code> (Redis backend)</li> </ul>"},{"location":"ARCHITECTURE/#assets-and-public-files","title":"Assets and public files","text":"<ul> <li>Public entry and assets under <code>public/</code>.</li> <li>Uploads and temporary files under:</li> <li><code>public/uploads</code></li> <li><code>public/temporary</code></li> </ul>"},{"location":"ARCHITECTURE/#directory-map","title":"Directory map","text":"<pre><code>application/\n  Bootstrap.php           # Application initialization\n  cache/                  # File-based cache storage\n  configs/\n    application.ini       # ZF1 settings, DB, mail\n    config.ini            # Domain-specific defaults\n  controllers/            # Default module controllers\n  languages/              # Translation files\n  layouts/                # View layouts\n  models/\n    DbTable/              # Zend_Db_Table models\n  modules/\n    admin/                # Admin panel module\n    api/                  # REST API module\n    reports/              # Reports module\n  services/               # Business logic layer\n  views/                  # View scripts\n\nlibrary/\n  Pt/\n    Cache/                # Redis cache backend\n    Commons/              # Utilities (logging, misc)\n    Helper/               # View helpers\n    Plugins/              # Controller plugins\n    Reports/              # Report generation\n\npublic/\n  index.php               # Web entry point\n  assets/                 # Static assets\n  uploads/                # User uploads\n  temporary/              # Temporary files\n\nscheduled-jobs/\n  ScheduledTasks.php      # Crunz schedule definitions\n  *.php                   # Individual job scripts\n\ndatabase/\n  migrations/             # SQL migration files\n  schema/                 # Database schema\n\nbin/\n  migrate.php             # Migration runner\n  run-once.php            # One-time script runner\n  *.php                   # CLI utilities\n\nlogs/                     # Application logs\n</code></pre>"},{"location":"ARCHITECTURE/#testing","title":"Testing","text":"<p>The codebase does not currently have automated tests. Unit and integration tests would improve maintainability.</p>"},{"location":"ARCHITECTURE/#notes-for-maintainers","title":"Notes for maintainers","text":"<ul> <li>ZF1 modules share the same services/models; avoid duplicating business logic in controllers.</li> <li>Prefer adding new shared behavior in <code>application/services</code> and keep controllers thin.</li> <li>Use <code>cli-bootstrap.php</code> for any new CLI tooling that needs ZF1 configs/services.</li> <li>The codebase integrates modern libraries (Monolog, Symfony Mailer) alongside ZF1 components.</li> <li>All background processing is cron-based (no daemon workers).</li> <li>Session-based authentication only; no OAuth/JWT support.</li> </ul>"},{"location":"AdminModuleGuide/","title":"Admin Module Guide","text":"<p>This document provides a comprehensive guide to the ePT Admin Module, covering workflows, controllers, and technical implementation details.</p>"},{"location":"AdminModuleGuide/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Overview</li> <li>User Roles</li> <li>Business Workflow</li> <li>Authentication and Authorization</li> <li>Module Structure</li> <li>Key Controllers</li> <li>AJAX Patterns</li> <li>Form Validation</li> <li>Common Patterns</li> <li>System Configuration</li> <li>Country-Specific Configurations</li> </ol>"},{"location":"AdminModuleGuide/#overview","title":"Overview","text":"<p>The Admin Module (<code>/admin</code>) is the PT Provider's interface for managing the entire proficiency testing lifecycle. It handles:</p> <ul> <li>PT Survey Management - Create and manage PT events/distributions</li> <li>Shipment Management - Add test panels under surveys with reference data</li> <li>Participant Management - Add, enroll, and track participants</li> <li>Evaluation - Score participant responses against reference data</li> <li>Report Generation - Generate Excel and PDF reports</li> <li>System Configuration - Test kits, assays, email templates, etc.</li> </ul>"},{"location":"AdminModuleGuide/#terminology","title":"Terminology","text":"Term Also Known As Description PT Survey PT Event, PT Distribution Container for one or more shipments Shipment Panel A specific test under a survey (one scheme type) Scheme Test Type DTS, VL, EID, TB, Recency, COVID-19, Custom Tests Participant Laboratory, Site, Tester Entity that receives and responds to PT shipments Data Manager Lab User Person who logs in to enter results on behalf of participants PTCC PT Country Coordinator National/regional user who oversees Data Managers"},{"location":"AdminModuleGuide/#user-roles","title":"User Roles","text":""},{"location":"AdminModuleGuide/#role-hierarchy","title":"Role Hierarchy","text":"<pre><code>flowchart TD\n    Admin[PT Administrator] --&gt; PTCC[PT Country Coordinator]\n    PTCC --&gt; DM[Data Managers]\n    DM --&gt; P[Participants]\n\n    subgraph \"Result Entry\"\n        DM --&gt;|enters results for| P\n    end\n</code></pre>"},{"location":"AdminModuleGuide/#participants-testers","title":"Participants (Testers)","text":"<p>Participants are the entities being tested for proficiency. They can be:</p> <ul> <li>Individual persons - A single tester</li> <li>Testing clinics/laboratories - An organization performing tests</li> </ul> <p>When a shipment is created, participants are enrolled (not Data Managers). Each participant receives samples, performs tests, and their results are evaluated.</p>"},{"location":"AdminModuleGuide/#data-managers","title":"Data Managers","text":"<p>Data Managers are the users who actually log into ePT to:</p> <ul> <li>Enter test results on behalf of participants</li> <li>Download reports for their assigned participants</li> <li>Track shipment status and due dates</li> </ul> <p>Key Rules:</p> Rule Description Minimum mapping Every participant must have at least one Data Manager assigned Multi-participant A Data Manager can manage multiple participants Self-management A participant can be their own Data Manager <p>Use Case - Remote Management:</p> <p>In areas with poor internet or computer access, testers may not be able to enter results directly. A Data Manager (perhaps at a regional office) can be assigned to enter results for multiple remote testing sites.</p>"},{"location":"AdminModuleGuide/#pt-country-coordinators-ptcc","title":"PT Country Coordinators (PTCC)","text":"<p>PTCC are national or regional-level users who:</p> <ul> <li>Do not manage PT (cannot create surveys, shipments, etc.)</li> <li>Oversee Data Managers assigned to them</li> <li>Track participation across their region</li> <li>Support program management at country level</li> </ul> <p>This role is useful for countries with decentralized PT programs where regional coordinators need visibility into local participation without full administrative access.</p>"},{"location":"AdminModuleGuide/#role-access-summary","title":"Role Access Summary","text":"Role Enter Results Download Reports Manage PT Oversee Users PT Administrator No (admin only) Yes (all) Yes Yes PTCC No Yes (assigned) No Yes (Data Managers) Data Manager Yes Yes (assigned) No No Participant Via Data Manager Via Data Manager No No"},{"location":"AdminModuleGuide/#business-workflow","title":"Business Workflow","text":""},{"location":"AdminModuleGuide/#complete-pt-lifecycle","title":"Complete PT Lifecycle","text":"<pre><code>flowchart TD\n    subgraph \"Setup Phase\"\n        A[Create PT Survey] --&gt; B[Add Shipment]\n        B --&gt; C[Set Reference Data]\n        C --&gt; D[Enroll Participants]\n    end\n\n    subgraph \"Distribution Phase\"\n        D --&gt; E[Ship PT Survey]\n        E --&gt; F[Participants Respond]\n    end\n\n    subgraph \"Evaluation Phase\"\n        F --&gt; G[Evaluate Responses]\n        G --&gt; H[Generate Reports]\n        H --&gt; G\n        Note1[Repeatable - Invisible to Participants]\n    end\n\n    subgraph \"Finalization Phase\"\n        H --&gt; I[Finalize Shipment]\n        I --&gt; J[Participants Download Reports]\n    end\n</code></pre>"},{"location":"AdminModuleGuide/#step-by-step-workflow","title":"Step-by-Step Workflow","text":""},{"location":"AdminModuleGuide/#1-create-pt-survey","title":"1. Create PT Survey","text":"<p>Location: Manage \u2192 PT Survey \u2192 Add New PT Survey</p> <ul> <li>Enter PT Survey Code (alphanumeric + hyphens)</li> <li>Select PT Survey Date</li> <li>Survey acts as a container for multiple shipments</li> </ul>"},{"location":"AdminModuleGuide/#2-add-shipments","title":"2. Add Shipment(s)","text":"<p>Location: PT Survey List \u2192 Add Scheme</p> <p>For each shipment: - Select scheme type (DTS, VL, EID, TB, etc.) - Set Shipment Code (auto-generated or custom) - Set Result Due Date - Add reference samples with expected results (qualitative tests) - Configure scheme-specific options (algorithms, test panels, etc.)</p>"},{"location":"AdminModuleGuide/#3-enroll-participants","title":"3. Enroll Participants","text":"<p>Location: Shipment List \u2192 Enroll button</p> <ul> <li>Select participants from available list</li> <li>Move to enrolled list</li> <li>Participants must be enrolled in the scheme first (Configure \u2192 Scheme Enrollments)</li> </ul>"},{"location":"AdminModuleGuide/#4-ship-the-pt-survey","title":"4. Ship the PT Survey","text":"<p>Location: Manage \u2192 PT Survey \u2192 Ship Now</p> <ul> <li>Confirms shipment is ready</li> <li>Makes shipment visible to enrolled participants</li> <li>Participants can now enter results</li> </ul>"},{"location":"AdminModuleGuide/#5-participant-response","title":"5. Participant Response","text":"<p>Location: Participant Portal \u2192 PT Result Submission</p> <ul> <li>Participants see shipped shipments</li> <li>Enter test results via response form</li> <li>Submit before due date</li> </ul>"},{"location":"AdminModuleGuide/#6-evaluate-responses","title":"6. Evaluate Responses","text":"<p>Location: Analyze \u2192 Evaluate Responses \u2192 View \u2192 Evaluate</p> <ul> <li>Compares participant responses to reference data</li> <li>Calculates scores (response score + documentation score)</li> <li>Determines pass/fail</li> <li>Can be run multiple times (not visible to participants)</li> </ul>"},{"location":"AdminModuleGuide/#7-generate-reports","title":"7. Generate Reports","text":"<p>Location: Analyze \u2192 Generate Reports \u2192 View \u2192 Report</p> <ul> <li>Generates participant reports (Excel, PDF)</li> <li>Can be regenerated as needed</li> <li>Still not visible to participants</li> </ul>"},{"location":"AdminModuleGuide/#8-finalize-shipment","title":"8. Finalize Shipment","text":"<p>Location: Analyze \u2192 Finalize Reports \u2192 View \u2192 Finalize</p> <ul> <li>Permanently closes the shipment</li> <li>Generates final reports</li> <li>Only now participants can download their result PDFs</li> <li>Cannot be undone</li> </ul>"},{"location":"AdminModuleGuide/#authentication-and-authorization","title":"Authentication and Authorization","text":""},{"location":"AdminModuleGuide/#session-management","title":"Session Management","text":"<p>Admin Session Namespace: <code>administrators</code></p> <pre><code>$adminSession = new Zend_Session_Namespace('administrators');\n// Contains: admin_id, primary_email, first_name, last_name, privileges, activeScheme\n</code></pre> <p>Session Duration: 10 hours (<code>Zend_Session::rememberMe(60 * 60 * 10)</code>)</p>"},{"location":"AdminModuleGuide/#login-flow","title":"Login Flow","text":"<pre><code>sequenceDiagram\n    participant U as Admin User\n    participant L as LoginController\n    participant DB as Database\n    participant S as Session\n\n    U-&gt;&gt;L: Submit credentials + CAPTCHA\n    L-&gt;&gt;L: Validate CAPTCHA\n    L-&gt;&gt;DB: Fetch admin by email\n    DB--&gt;&gt;L: Admin record\n    L-&gt;&gt;L: password_verify()\n    L-&gt;&gt;S: Create session, regenerate ID\n    L-&gt;&gt;DB: Log to user_login_history\n    L-&gt;&gt;U: Redirect to /admin\n</code></pre>"},{"location":"AdminModuleGuide/#pt-managers-admin-users","title":"PT Managers (Admin Users)","text":"<p>PT Managers are the users who access the admin area (<code>/admin</code>). Each PT Manager can have:</p> <ol> <li>Scheme Access - Access to all active schemes or only specific ones (e.g., only DTS and TB)</li> <li>Privileges - All privileges or only specific ones</li> </ol>"},{"location":"AdminModuleGuide/#privilege-system","title":"Privilege System","text":"<p>Privileges are stored as comma-separated values in <code>system_admin.privileges</code>:</p> Privilege Access Granted <code>config-ept</code> Configure ePT - System configuration, PT Managers, global settings <code>manage-participants</code> Manage Participants - Participant management, data managers, enrollments <code>manage-shipments</code> Manage Shipments - Shipments, distributions, shipping <code>analyze-generate-reports</code> Analyze and Generate Reports - Evaluation, reports, finalization <code>edit-participant-responses</code> Edit Participant Responses - Modify submitted participant data <code>access-reports</code> Access Reports - View and download reports <code>delete-participants</code> Delete Participants - Remove participant records <code>replace-finalized-summary-reports</code> Replace Finalized Summary Reports - Override finalized reports <p>Checking Privileges: <pre><code>$privileges = explode(',', $adminSession-&gt;privileges);\nif (!in_array('manage-shipments', $privileges)) {\n    $this-&gt;redirect('/admin');\n}\n</code></pre></p>"},{"location":"AdminModuleGuide/#csrf-protection","title":"CSRF Protection","text":"<ul> <li>Token Generation: 64-character hex string</li> <li>Storage: <code>csrf</code> session namespace</li> <li>Validation: Header <code>X-CSRF-Token</code> or POST <code>csrf_token</code></li> <li>Exempt: AJAX requests, API module, GET requests</li> </ul>"},{"location":"AdminModuleGuide/#module-structure","title":"Module Structure","text":""},{"location":"AdminModuleGuide/#directory-layout","title":"Directory Layout","text":"<pre><code>application/modules/admin/\n\u251c\u2500\u2500 controllers/           # 41 controller files\n\u2502   \u251c\u2500\u2500 IndexController.php         # Dashboard\n\u2502   \u251c\u2500\u2500 LoginController.php         # Authentication\n\u2502   \u251c\u2500\u2500 ShipmentController.php      # Shipment management\n\u2502   \u251c\u2500\u2500 DistributionsController.php # PT Survey management\n\u2502   \u251c\u2500\u2500 ParticipantsController.php  # Participant management\n\u2502   \u251c\u2500\u2500 EvaluateController.php      # Evaluation &amp; scoring\n\u2502   \u2514\u2500\u2500 ...\n\u2502\n\u2514\u2500\u2500 views/scripts/         # View templates by controller\n    \u251c\u2500\u2500 shipment/\n    \u2502   \u251c\u2500\u2500 index.phtml\n    \u2502   \u251c\u2500\u2500 add.phtml\n    \u2502   \u251c\u2500\u2500 edit.phtml\n    \u2502   \u251c\u2500\u2500 get-sample-form.ajax.phtml\n    \u2502   \u2514\u2500\u2500 partials/\n    \u2502       \u251c\u2500\u2500 common/    # Shared form components\n    \u2502       \u2514\u2500\u2500 schemes/   # Scheme-specific forms\n    \u251c\u2500\u2500 distributions/\n    \u251c\u2500\u2500 participants/\n    \u251c\u2500\u2500 evaluate/\n    \u2514\u2500\u2500 ...\n</code></pre>"},{"location":"AdminModuleGuide/#controller-categories","title":"Controller Categories","text":"Category Controllers Purpose Core IndexController, LoginController Dashboard, auth PT Management DistributionsController, ShipmentController Surveys &amp; shipments Participants ParticipantsController, DataManagersController, EnrollmentsController User management Evaluation EvaluateController Scoring &amp; results Configuration GlobalConfigController, TestkitController, various *SettingsController System setup Communication EmailParticipantsController, AnnouncementController, AlertsController Notifications"},{"location":"AdminModuleGuide/#key-controllers","title":"Key Controllers","text":""},{"location":"AdminModuleGuide/#shipmentcontroller","title":"ShipmentController","text":"<p>Location: <code>application/modules/admin/controllers/ShipmentController.php</code></p> <p>Required Privilege: <code>manage-shipments</code></p>"},{"location":"AdminModuleGuide/#key-actions","title":"Key Actions","text":"Action Method Purpose <code>indexAction</code> GET/POST List shipments with filtering <code>addAction</code> GET/POST Create new shipment under distribution <code>editAction</code> GET/POST Modify shipment details and samples <code>getSampleFormAction</code> POST (AJAX) Load scheme-specific sample form <code>shipItAction</code> GET/POST Ship out to enrolled participants <code>viewEnrollmentsAction</code> GET/POST View/manage enrolled participants <code>addEnrollmentsAction</code> POST Enroll participants in shipment <code>responseSwitchAction</code> POST (AJAX) Toggle response acceptance on/off"},{"location":"AdminModuleGuide/#services-used","title":"Services Used","text":"<pre><code>$shipmentService = new Application_Service_Shipments();\n$schemeService = new Application_Service_Schemes();\n$participantService = new Application_Service_Participants();\n$distributionService = new Application_Service_Distribution();\n</code></pre>"},{"location":"AdminModuleGuide/#evaluatecontroller","title":"EvaluateController","text":"<p>Location: <code>application/modules/admin/controllers/EvaluateController.php</code></p> <p>Required Privilege: <code>analyze-generate-reports</code></p>"},{"location":"AdminModuleGuide/#key-actions_1","title":"Key Actions","text":"Action Method Purpose <code>indexAction</code> GET List distributions for evaluation <code>getShipmentsAction</code> POST (AJAX) Get shipments under distribution <code>scheduleEvaluationAction</code> POST (AJAX) Queue evaluation job <code>shipmentAction</code> GET View shipment for evaluation <code>editAction</code> GET/POST Evaluate with manual overrides <code>vlRangeAction</code> GET/POST (AJAX) Configure VL Z-score ranges <code>excludeParticipantAction</code> POST (AJAX) Exclude participant from scoring"},{"location":"AdminModuleGuide/#evaluation-flow","title":"Evaluation Flow","text":"<pre><code>sequenceDiagram\n    participant A as Admin\n    participant EC as EvaluateController\n    participant ES as Evaluation Service\n    participant M as Scheme Model\n    participant DB as Database\n\n    A-&gt;&gt;EC: scheduleEvaluationAction\n    EC-&gt;&gt;ES: scheduleEvaluation()\n    ES-&gt;&gt;DB: Insert scheduled_jobs\n    Note over DB: Job queue picks up\n    DB-&gt;&gt;M: evaluate($shipmentResult, $shipmentId)\n    M-&gt;&gt;DB: Compare responses vs reference\n    M-&gt;&gt;DB: Update shipment_participant_map\n    M--&gt;&gt;A: Evaluation complete\n</code></pre>"},{"location":"AdminModuleGuide/#distributionscontroller","title":"DistributionsController","text":"<p>Location: <code>application/modules/admin/controllers/DistributionsController.php</code></p> <p>Required Privilege: <code>manage-shipments</code></p>"},{"location":"AdminModuleGuide/#key-actions_2","title":"Key Actions","text":"Action Method Purpose <code>indexAction</code> GET/POST List PT Surveys <code>addAction</code> GET/POST Create new PT Survey <code>editAction</code> GET/POST Modify PT Survey <code>viewShipmentAction</code> GET (AJAX) Get shipments under survey <code>shipDistributionAction</code> GET Ship the entire survey <code>generateSurveyCodeAction</code> POST (AJAX) Auto-generate survey code"},{"location":"AdminModuleGuide/#participantscontroller","title":"ParticipantsController","text":"<p>Location: <code>application/modules/admin/controllers/ParticipantsController.php</code></p> <p>Required Privilege: <code>config-ept</code> OR <code>manage-participants</code></p>"},{"location":"AdminModuleGuide/#key-actions_3","title":"Key Actions","text":"Action Method Purpose <code>indexAction</code> GET/POST List participants (DataTables) <code>addAction</code> GET/POST Add single participant <code>editAction</code> GET/POST Modify participant <code>bulkImportAction</code> GET/POST Bulk import from Excel <code>participantManagerMapAction</code> GET/POST Assign data managers <code>exportParticipantsDetailsAction</code> POST (AJAX) Export to Excel"},{"location":"AdminModuleGuide/#ajax-patterns","title":"AJAX Patterns","text":""},{"location":"AdminModuleGuide/#ajaxcontext-registration","title":"AjaxContext Registration","text":"<p>Controllers register AJAX actions in <code>init()</code>:</p> <pre><code>public function init()\n{\n    $ajaxContext = $this-&gt;_helper-&gt;getHelper('AjaxContext');\n    $ajaxContext-&gt;addActionContext('get-sample-form', 'html')\n        -&gt;addActionContext('get-shipment-code', 'html')\n        -&gt;addActionContext('view-enrollments', 'html')\n        -&gt;initContext();\n}\n</code></pre>"},{"location":"AdminModuleGuide/#common-ajax-file-pattern","title":"Common AJAX File Pattern","text":"<p>AJAX views use <code>.ajax.phtml</code> suffix and return HTML or JSON:</p> <pre><code>views/scripts/{controller}/\n\u251c\u2500\u2500 index.phtml           # Regular view\n\u251c\u2500\u2500 add.phtml\n\u251c\u2500\u2500 get-data.ajax.phtml   # AJAX response (HTML)\n\u2514\u2500\u2500 search.ajax.phtml\n</code></pre>"},{"location":"AdminModuleGuide/#datatables-server-side","title":"DataTables Server-Side","text":"<p>Used for paginated lists:</p> <pre><code>$('#participantsTable').dataTable({\n    \"bServerSide\": true,\n    \"sAjaxSource\": \"/admin/participants/index/format/html\",\n    \"fnServerData\": function(sSource, aoData, fnCallback) {\n        $.ajax({\n            type: \"POST\",\n            url: sSource,\n            data: aoData,\n            success: fnCallback\n        });\n    }\n});\n</code></pre>"},{"location":"AdminModuleGuide/#select2-ajax-dropdowns","title":"Select2 AJAX Dropdowns","text":"<p>For searchable dropdowns:</p> <pre><code>$(\"#labId\").select2({\n    ajax: {\n        url: \"/reports/common/get-ajax-drop-downs\",\n        dataType: 'json',\n        data: function(params) {\n            return { tableName: 'participant', search: params.term };\n        },\n        processResults: function(data) {\n            return { results: data.result };\n        }\n    }\n});\n</code></pre>"},{"location":"AdminModuleGuide/#json-response-pattern","title":"JSON Response Pattern","text":"<p>For API-style responses:</p> <pre><code>public function getDataAction()\n{\n    $this-&gt;_helper-&gt;layout()-&gt;disableLayout();\n    $this-&gt;_helper-&gt;viewRenderer-&gt;setNoRender(true);\n\n    $data = $this-&gt;service-&gt;getData($this-&gt;getAllParams());\n\n    $this-&gt;getResponse()-&gt;setHeader('Content-Type', 'application/json');\n    echo json_encode($data);\n}\n</code></pre>"},{"location":"AdminModuleGuide/#form-validation","title":"Form Validation","text":""},{"location":"AdminModuleGuide/#client-side-deforayvalidator","title":"Client-Side: deforayValidator","text":"<p>Location: <code>public/js/deforayValidation.js</code></p> <p>Apply validation via CSS classes:</p> <pre><code>&lt;input type=\"email\" name=\"email\"\n       class=\"isRequired isEmail form-control\"\n       title=\"Please enter a valid email address\"&gt;\n</code></pre> <p>Available Validators:</p> Class Validation <code>isRequired</code> Field cannot be empty <code>isEmail</code> Valid email format <code>isNumeric</code> Numbers only <code>isAlpha</code> Letters only <code>isAlphaNum</code> Alphanumeric only <code>minLength_N</code> Minimum N characters <code>maxLength_N</code> Maximum N characters <code>confirmPassword</code> Matches password field <p>Usage:</p> <pre><code>function validateNow() {\n    var flag = deforayValidator.init({ formId: 'shipmentForm' });\n    if (flag &amp;&amp; !duplicated) {\n        $.blockUI();\n        document.getElementById('shipmentForm').submit();\n    }\n}\n</code></pre>"},{"location":"AdminModuleGuide/#duplicate-checking","title":"Duplicate Checking","text":"<p>Real-time AJAX validation for unique fields:</p> <pre><code>&lt;input type=\"text\" name=\"partnerName\"\n       onblur=\"checkDuplicate('partners', 'partner_name', 'partnerName', null, 'Name already exists')\"&gt;\n</code></pre> <p>For edit forms (exclude current record):</p> <pre><code>&lt;input type=\"text\" name=\"partnerName\"\n       onblur=\"checkDuplicate('partners', 'partner_name', 'partnerName',\n               'partner_id##&lt;?php echo $this-&gt;partner['partner_id']; ?&gt;', 'Name already exists')\"&gt;\n</code></pre>"},{"location":"AdminModuleGuide/#server-side-validation","title":"Server-Side Validation","text":"<p>Common Service (<code>application/services/Common.php</code>):</p> <pre><code>// Email validation\n$validEmail = $commonService-&gt;validateEmail($email);\n\n// Password validation\n$result = $commonService-&gt;validatePassword($password, $name, $email);\n\n// Required fields\n$valid = $commonService-&gt;validateRequiredFields($formData, ['field1', 'field2']);\n</code></pre>"},{"location":"AdminModuleGuide/#common-patterns","title":"Common Patterns","text":""},{"location":"AdminModuleGuide/#base64-parameter-encoding","title":"Base64 Parameter Encoding","text":"<p>Sensitive IDs are base64 encoded in URLs:</p> <pre><code>// Encoding (in view)\n$encodedId = base64_encode($shipment['shipment_id']);\n&lt;a href=\"/admin/shipment/edit/sid/&lt;?php echo $encodedId; ?&gt;\"&gt;Edit&lt;/a&gt;\n\n// Decoding (in controller)\n$shipmentId = (int) base64_decode($this-&gt;_getParam('sid'));\n</code></pre>"},{"location":"AdminModuleGuide/#layout-management","title":"Layout Management","text":"<pre><code>// Set page identifier for menu highlighting\n$this-&gt;view-&gt;pageName = 'manageMenu';\n\n// Disable layout for AJAX\n$this-&gt;_helper-&gt;layout()-&gt;disableLayout();\n\n// Use modal layout\n$this-&gt;_helper-&gt;layout-&gt;setLayout('modal');\n</code></pre>"},{"location":"AdminModuleGuide/#service-layer-pattern","title":"Service Layer Pattern","text":"<p>Controllers delegate to services:</p> <pre><code>// Controller (thin)\npublic function addAction()\n{\n    if ($this-&gt;getRequest()-&gt;isPost()) {\n        $this-&gt;shipmentService-&gt;addShipment($this-&gt;getRequest()-&gt;getPost());\n        $this-&gt;redirect('/admin/shipment');\n    }\n}\n\n// Service (business logic)\npublic function addShipment($params)\n{\n    // Validation, transformation, DB operations\n    $shipmentDb = new Application_Model_DbTable_Shipments();\n    return $shipmentDb-&gt;addShipment($params);\n}\n</code></pre>"},{"location":"AdminModuleGuide/#redirect-after-post","title":"Redirect After POST","text":"<p>Standard pattern to prevent duplicate submissions:</p> <pre><code>if ($request-&gt;isPost()) {\n    $service-&gt;processData($request-&gt;getPost());\n    $this-&gt;redirect('/admin/controller');  // Always redirect\n}\n</code></pre>"},{"location":"AdminModuleGuide/#system-configuration","title":"System Configuration","text":""},{"location":"AdminModuleGuide/#global-config-scheme-activation","title":"Global Config - Scheme Activation","text":"<p>Not all deployments use all test schemes. In Global Config, administrators can enable/disable which schemes are active for the current instance:</p> <ul> <li>Some deployments use only DTS (HIV Serology)</li> <li>Some use only TB</li> <li>Some use multiple schemes (DTS, VL, EID)</li> <li>Custom Tests can be configured for organization-specific needs</li> </ul> <p>When a PT Manager is created, they can be granted access to all active schemes or only specific ones.</p>"},{"location":"AdminModuleGuide/#test-kits","title":"Test Kits","text":"<p>Test kits are a critical component of ePT:</p> <ul> <li>Pre-loaded kits - System includes standard test kits commonly used in PT programs</li> <li>Custom kits - Users can add their own test kits specific to their region/program</li> <li>Kit assignment - Admins configure which test kits are available for each scheme</li> </ul> <p>Location: Configure \u2192 Test Kits</p>"},{"location":"AdminModuleGuide/#scheme-specific-settings","title":"Scheme-Specific Settings","text":"<p>Non-custom schemes have dedicated configuration pages:</p> Scheme Settings Page Key Configurations DTS DTS Settings Algorithm type, test panel count, result options VL VL Settings Assay list, Z-score thresholds, reference methods EID EID Settings Result interpretation rules TB TB Settings Molecular vs microscopy options, drug resistance Recency Recency Settings RTRI cutoffs, viral load thresholds COVID-19 COVID-19 Settings Platform options, Ct value ranges <p>Location: Configure \u2192 {Scheme} Settings</p>"},{"location":"AdminModuleGuide/#multi-test-algorithms-hiv-serology","title":"Multi-Test Algorithms (HIV Serology)","text":"<p>For HIV Serology testing (DTS), participants often run multiple tests before drawing a conclusion:</p> <pre><code>Test-1 (Screening) \u2192 Test-2 (Confirmatory) \u2192 Test-3 (Tiebreaker) \u2192 Final Interpretation\n</code></pre> <p>Administrators configure:</p> <ol> <li>Which test kits are available for each test position (Test-1, Test-2, Test-3)</li> <li>Algorithm rules for how results combine to produce the final interpretation</li> <li>Expected results for each reference sample</li> </ol> <p>This allows flexibility for different national algorithms (WHO 3-test, Malawi algorithm, etc.).</p>"},{"location":"AdminModuleGuide/#country-specific-configurations","title":"Country-Specific Configurations","text":"<p>ePT is deployed globally with country-specific adaptations:</p>"},{"location":"AdminModuleGuide/#testing-algorithms","title":"Testing Algorithms","text":"Country Algorithm WHO Standard 3-test algorithm Malawi Custom algorithm with PT Email/Phone fields Myanmar Custom algorithm Zimbabwe Custom algorithm <p>The <code>reportType</code> configuration determines which fields appear:</p> <pre><code>if ($this-&gt;reportType == 'malawi') {\n    // Show PT Email and PT Phone fields\n}\n</code></pre>"},{"location":"AdminModuleGuide/#scheme-origins","title":"Scheme Origins","text":"Scheme Description Notes DTS HIV Serology (Dried Tube Specimen) Original scheme, core functionality VL HIV Viral Load Quantitative testing with Z-score analysis EID Early Infant Diagnosis PCR-based infant HIV testing TB Tuberculosis Molecular (GeneXpert) OR Microscopy Recency HIV Recency RTRI-based recent infection testing COVID-19 COVID-19 Testing Added during pandemic, multi-platform PCR DBS Dried Blood Spot EIA and Western Blot testing Custom Tests User-configurable Added by popular request for organization-specific tests"},{"location":"AdminModuleGuide/#related-documentation","title":"Related Documentation","text":"<ul> <li>Architecture Guide - System-wide architecture</li> <li>Scheme Architecture - Test scheme implementation details</li> <li>Documentation Index - All documentation</li> </ul>"},{"location":"SchemeArchitecture/","title":"Scheme Architecture Guide","text":"<p>This document explains how test schemes (DTS, VL, EID, TB, Recency, COVID-19, DBS, Custom Tests) are organized in the EPT project. Use this as a reference when maintaining existing schemes or adding new ones.</p>"},{"location":"SchemeArchitecture/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Overview</li> <li>Directory Structure</li> <li>Scheme Components</li> <li>Data Flow</li> <li>Adding a New Scheme</li> <li>Scheme-Specific Details</li> </ol>"},{"location":"SchemeArchitecture/#overview","title":"Overview","text":"<p>Each scheme in EPT follows a consistent MVC architecture:</p> <pre><code>graph TB\n    subgraph \"Participant Flow\"\n        P[Participant] --&gt; PC[\"{Scheme}Controller\"]\n        PC --&gt; PV[\"views/scripts/{scheme}/response.phtml\"]\n        PC --&gt; SS[\"Shipments Service\"]\n    end\n\n    subgraph \"Admin Flow\"\n        A[Admin] --&gt; SC[\"ShipmentController\"]\n        SC --&gt; AP[\"partials/schemes/{scheme}.phtml\"]\n        SC --&gt; ES[\"Evaluation Service\"]\n    end\n\n    subgraph \"Data Layer\"\n        SS --&gt; DT[\"DbTable/Response{Scheme}\"]\n        ES --&gt; M[\"Model/{Scheme}.php\"]\n        DT --&gt; DB[(Database)]\n        M --&gt; DB\n    end\n\n    subgraph \"Database Tables\"\n        DB --&gt; RR[\"response_result_{scheme}\"]\n        DB --&gt; REF[\"reference_result_{scheme}\"]\n        DB --&gt; SPM[\"shipment_participant_map\"]\n    end\n</code></pre> Component Purpose Location Model Evaluation logic, scoring, reports <code>application/models/{Scheme}.php</code> Controller Request handling, response entry <code>application/controllers/{Scheme}Controller.php</code> Views Participant response forms <code>application/views/scripts/{scheme}/</code> DbTable Database persistence <code>application/models/DbTable/Response{Scheme}.php</code> Admin Partial Shipment add/edit forms <code>application/modules/admin/views/scripts/shipment/partials/schemes/{scheme}.phtml</code>"},{"location":"SchemeArchitecture/#directory-structure","title":"Directory Structure","text":"<pre><code>application/\n\u251c\u2500\u2500 models/\n\u2502   \u251c\u2500\u2500 Dts.php                    # DTS evaluation &amp; reports\n\u2502   \u251c\u2500\u2500 Vl.php                     # VL evaluation &amp; reports\n\u2502   \u251c\u2500\u2500 Tb.php                     # TB evaluation &amp; reports\n\u2502   \u251c\u2500\u2500 Eid.php                    # EID evaluation &amp; reports\n\u2502   \u251c\u2500\u2500 Recency.php                # Recency evaluation &amp; reports\n\u2502   \u251c\u2500\u2500 Covid19.php                # COVID-19 evaluation &amp; reports\n\u2502   \u251c\u2500\u2500 CustomTest.php             # Custom Tests evaluation\n\u2502   \u2514\u2500\u2500 DbTable/\n\u2502       \u251c\u2500\u2500 ResponseDts.php        # response_result_dts table\n\u2502       \u251c\u2500\u2500 ResponseVl.php         # response_result_vl table\n\u2502       \u251c\u2500\u2500 ResponseTb.php         # response_result_tb table\n\u2502       \u251c\u2500\u2500 ResponseEid.php        # response_result_eid table\n\u2502       \u251c\u2500\u2500 ResponseRecency.php    # response_result_recency table\n\u2502       \u251c\u2500\u2500 ResponseCovid19.php    # response_result_covid19 table\n\u2502       \u251c\u2500\u2500 ResponseDbs.php        # response_result_dbs table\n\u2502       \u251c\u2500\u2500 ResponseGenericTest.php # response_result_generic_test table (Custom Tests)\n\u2502       \u251c\u2500\u2500 Shipments.php          # shipment table\n\u2502       \u2514\u2500\u2500 ShipmentParticipantMap.php # shipment_participant_map table\n\u2502\n\u251c\u2500\u2500 controllers/\n\u2502   \u251c\u2500\u2500 DtsController.php          # DTS response entry\n\u2502   \u251c\u2500\u2500 VlController.php           # VL response entry\n\u2502   \u251c\u2500\u2500 TbController.php           # TB response entry\n\u2502   \u251c\u2500\u2500 EidController.php          # EID response entry\n\u2502   \u251c\u2500\u2500 RecencyController.php      # Recency response entry\n\u2502   \u251c\u2500\u2500 Covid19Controller.php      # COVID-19 response entry\n\u2502   \u251c\u2500\u2500 DbsController.php          # DBS response entry\n\u2502   \u2514\u2500\u2500 CustomTestController.php   # Custom Tests response entry\n\u2502\n\u251c\u2500\u2500 views/scripts/\n\u2502   \u251c\u2500\u2500 dts/response.phtml         # DTS response form\n\u2502   \u251c\u2500\u2500 vl/response.phtml          # VL response form\n\u2502   \u251c\u2500\u2500 tb/response.phtml          # TB response form\n\u2502   \u251c\u2500\u2500 eid/response.phtml         # EID response form\n\u2502   \u251c\u2500\u2500 recency/response.phtml     # Recency response form\n\u2502   \u251c\u2500\u2500 covid19/response.phtml     # COVID-19 response form\n\u2502   \u251c\u2500\u2500 dbs/response.phtml         # DBS response form\n\u2502   \u2514\u2500\u2500 custom-test/response.phtml # Custom Tests response form\n\u2502\n\u251c\u2500\u2500 services/\n\u2502   \u251c\u2500\u2500 Shipments.php              # updateDtsResults(), updateVlResults(), etc.\n\u2502   \u251c\u2500\u2500 Schemes.php                # getPossibleResults(), getSchemeControls(), etc.\n\u2502   \u251c\u2500\u2500 Evaluation.php             # Evaluation workflow management\n\u2502   \u2514\u2500\u2500 Reports.php                # Report generation\n\u2502\n\u2514\u2500\u2500 modules/admin/views/scripts/shipment/\n    \u251c\u2500\u2500 edit.phtml                 # Slim wrapper (includes partials)\n    \u251c\u2500\u2500 get-sample-form.ajax.phtml # AJAX loader for ADD flow\n    \u2514\u2500\u2500 partials/\n        \u251c\u2500\u2500 common/\n        \u2502   \u251c\u2500\u2500 form-header.phtml  # Shared header fields\n        \u2502   \u251c\u2500\u2500 form-footer.phtml  # Submit buttons\n        \u2502   \u2514\u2500\u2500 form-scripts.phtml # Shared JavaScript\n        \u2514\u2500\u2500 schemes/\n            \u251c\u2500\u2500 dts.phtml          # DTS shipment form\n            \u251c\u2500\u2500 vl.phtml           # VL shipment form\n            \u251c\u2500\u2500 tb.phtml           # TB shipment form\n            \u251c\u2500\u2500 eid.phtml          # EID shipment form\n            \u251c\u2500\u2500 recency.phtml      # Recency shipment form\n            \u251c\u2500\u2500 covid19.phtml      # COVID-19 shipment form\n            \u251c\u2500\u2500 dbs.phtml          # DBS shipment form\n            \u2514\u2500\u2500 generic.phtml      # Custom Tests shipment form\n</code></pre>"},{"location":"SchemeArchitecture/#scheme-components","title":"Scheme Components","text":""},{"location":"SchemeArchitecture/#1-model-applicationmodelsschemephp","title":"1. Model (<code>application/models/{Scheme}.php</code>)","text":"<p>Each scheme model contains the <code>evaluate()</code> method - the core evaluation logic:</p> <pre><code>public function evaluate($shipmentResult, $shipmentId, $reEvaluate = false)\n{\n    // 1. Fetch reference results\n    // 2. Compare participant responses vs reference\n    // 3. Calculate scores (response + documentation)\n    // 4. Determine pass/fail\n    // 5. Update shipment_participant_map with results\n    // 6. Return evaluation summary\n}\n</code></pre> <p>Key Methods in Models:</p> Method Purpose <code>evaluate()</code> Core scoring logic <code>generate{Scheme}ExcelReport()</code> Excel report generation <code>getDataForIndividualPDFBatch()</code> PDF report data <code>get{Scheme}Samples()</code> Retrieve sample data <p>Model Sizes (complexity indicator): - TB.php: 133K (most complex - molecular/microscopy) - VL.php: 114K (Z-score calculations) - DTS.php: 111K (multiple algorithms) - Covid19.php: 79K - CustomTest.php: 79K - Recency.php: 63K - Eid.php: 21K (simplest)</p>"},{"location":"SchemeArchitecture/#2-controller-applicationcontrollersschemecontrollerphp","title":"2. Controller (<code>application/controllers/{Scheme}Controller.php</code>)","text":"<p>Handles participant response entry:</p> <pre><code>public function responseAction()\n{\n    if ($this-&gt;getRequest()-&gt;isPost()) {\n        // Save results via service layer\n        $this-&gt;shipmentService-&gt;update{Scheme}Results($data);\n        // Redirect appropriately\n    } else {\n        // Load form data\n        $this-&gt;view-&gt;samples = $this-&gt;schemeService-&gt;get{Scheme}Samples();\n        $this-&gt;view-&gt;possibleResults = $this-&gt;schemeService-&gt;getPossibleResults();\n        // Render response.phtml\n    }\n}\n</code></pre> <p>Common Controller Actions: - <code>responseAction()</code> - Main response entry (GET: show form, POST: save) - <code>downloadAction()</code> - Download reference data/reports - <code>deleteAction()</code> - Delete response (if applicable)</p>"},{"location":"SchemeArchitecture/#3-response-view-applicationviewsscriptsschemeresponsephtml","title":"3. Response View (<code>application/views/scripts/{scheme}/response.phtml</code>)","text":"<p>Participant-facing form for entering test results. Common elements:</p> <ul> <li>Laboratory/Participant information</li> <li>Receipt and testing dates</li> <li>Assay/kit selection</li> <li>Results table (scheme-specific columns)</li> <li>QC section (conditional)</li> <li>Supervisor review</li> <li>File upload (some schemes)</li> <li>Manual override (admin only)</li> </ul>"},{"location":"SchemeArchitecture/#4-dbtable-applicationmodelsdbtableresponseschemephp","title":"4. DbTable (<code>application/models/DbTable/Response{Scheme}.php</code>)","text":"<p>Database persistence layer:</p> <pre><code>class Application_Model_DbTable_ResponseDts extends Zend_Db_Table_Abstract\n{\n    protected $_name = 'response_result_dts';\n    protected $_primary = array('shipment_map_id', 'sample_id');\n\n    public function updateResults($params)\n    {\n        // Insert or update response records\n    }\n\n    public function updateResultsByAPI($params, $dm)\n    {\n        // API-based result submission\n    }\n}\n</code></pre>"},{"location":"SchemeArchitecture/#5-admin-partial-partialsschemesschemephtml","title":"5. Admin Partial (<code>partials/schemes/{scheme}.phtml</code>)","text":"<p>Unified shipment add/edit form that works for both flows:</p> <pre><code>&lt;?php\n// Mode detection\n$isEditMode = isset($this-&gt;shipmentData) &amp;&amp; !empty($this-&gt;shipmentData);\n\n// Normalize data\n$samples = $isEditMode\n    ? $this-&gt;shipmentData['reference']\n    : $this-&gt;schemeControls;\n\n$possibleResults = $isEditMode\n    ? $this-&gt;shipmentData['possibleResults']\n    : $this-&gt;schemePossibleResults;\n?&gt;\n&lt;!-- Form HTML works for both ADD and EDIT --&gt;\n</code></pre>"},{"location":"SchemeArchitecture/#data-flow","title":"Data Flow","text":""},{"location":"SchemeArchitecture/#participant-response-flow","title":"Participant Response Flow","text":"<pre><code>sequenceDiagram\n    participant P as Participant\n    participant D as Dashboard\n    participant C as {Scheme}Controller\n    participant S as Shipments Service\n    participant DB as Database\n\n    P-&gt;&gt;D: View available shipments\n    D-&gt;&gt;P: Show scheme list\n    P-&gt;&gt;C: Click \"Enter Results\" (GET)\n    C-&gt;&gt;C: Load samples, testkits, possible results\n    C-&gt;&gt;P: Render response.phtml form\n    P-&gt;&gt;C: Submit results (POST)\n    C-&gt;&gt;S: update{Scheme}Results($data)\n    S-&gt;&gt;DB: Insert/Update response_result_{scheme}\n    S-&gt;&gt;DB: Update shipment_participant_map status\n    DB--&gt;&gt;C: Success\n    C-&gt;&gt;P: Redirect to dashboard\n</code></pre>"},{"location":"SchemeArchitecture/#evaluation-flow","title":"Evaluation Flow","text":"<pre><code>sequenceDiagram\n    participant A as Admin\n    participant EC as EvaluateController\n    participant ES as Evaluation Service\n    participant M as {Scheme} Model\n    participant DB as Database\n\n    A-&gt;&gt;EC: Trigger evaluation\n    EC-&gt;&gt;ES: getShipmentToEvaluate()\n    ES-&gt;&gt;DB: Load participant responses\n    DB--&gt;&gt;ES: Response data\n    ES-&gt;&gt;M: evaluate($shipmentResult, $shipmentId)\n    M-&gt;&gt;DB: Fetch reference_result_{scheme}\n    DB--&gt;&gt;M: Reference data\n    M-&gt;&gt;M: Compare responses vs reference\n    M-&gt;&gt;M: Calculate scores\n    M-&gt;&gt;M: Determine pass/fail\n    M-&gt;&gt;DB: Update shipment_participant_map\n    Note over DB: shipment_score, documentation_score,&lt;br/&gt;final_result, failure_reason\n    M--&gt;&gt;EC: Evaluation complete\n    EC-&gt;&gt;A: Show results\n</code></pre>"},{"location":"SchemeArchitecture/#shipment-creation-flow-admin","title":"Shipment Creation Flow (Admin)","text":"<pre><code>sequenceDiagram\n    participant A as Admin\n    participant I as index.phtml\n    participant SC as ShipmentController\n    participant AJAX as get-sample-form.ajax\n    participant P as partials/schemes/{scheme}\n    participant DB as Database\n\n    A-&gt;&gt;I: Select scheme from dropdown\n    I-&gt;&gt;SC: getSampleFormAction() [AJAX]\n    SC-&gt;&gt;AJAX: Load form partial\n    AJAX-&gt;&gt;P: Include scheme partial\n    P--&gt;&gt;A: Render form fields\n    A-&gt;&gt;A: Fill in sample details\n    A-&gt;&gt;SC: Submit (addAction/editAction)\n    SC-&gt;&gt;DB: Save to shipment table\n    SC-&gt;&gt;DB: Save to reference_result_{scheme}\n    DB--&gt;&gt;SC: Success\n    SC-&gt;&gt;A: Redirect to shipment list\n</code></pre>"},{"location":"SchemeArchitecture/#database-tables","title":"Database Tables","text":""},{"location":"SchemeArchitecture/#core-tables","title":"Core Tables","text":"Table Purpose <code>shipment</code> Shipment metadata, status, configuration <code>shipment_participant_map</code> Links shipments to participants, stores scores <code>scheme_list</code> Scheme definitions and configuration"},{"location":"SchemeArchitecture/#per-scheme-tables","title":"Per-Scheme Tables","text":"Scheme Response Table Reference Table DTS <code>response_result_dts</code> <code>reference_result_dts</code> VL <code>response_result_vl</code> <code>reference_result_vl</code> TB <code>response_result_tb</code> <code>reference_result_tb</code> EID <code>response_result_eid</code> <code>reference_result_eid</code> Recency <code>response_result_recency</code> <code>reference_result_recency</code> COVID-19 <code>response_result_covid19</code> <code>reference_result_covid19</code> DBS <code>response_result_dbs</code> <code>reference_result_dbs</code> Custom Tests <code>response_result_generic_test</code> (uses scheme config)"},{"location":"SchemeArchitecture/#table-relationships","title":"Table Relationships","text":"<pre><code>erDiagram\n    shipment ||--o{ shipment_participant_map : \"has participants\"\n    shipment ||--o{ reference_result : \"has reference samples\"\n    shipment_participant_map ||--o{ response_result : \"has responses\"\n    participant ||--o{ shipment_participant_map : \"enrolled in\"\n\n    shipment {\n        int shipment_id PK\n        string shipment_code\n        string scheme_type\n        int distribution_id\n        string status\n        json shipment_attributes\n    }\n\n    shipment_participant_map {\n        int map_id PK\n        int shipment_id FK\n        int participant_id FK\n        string response_status\n        decimal shipment_score\n        decimal documentation_score\n        int final_result\n        json failure_reason\n    }\n\n    reference_result {\n        int shipment_id PK\n        string sample_id PK\n        string reference_result\n        int sample_score\n    }\n\n    response_result {\n        int shipment_map_id PK\n        string sample_id PK\n        string reported_result\n        timestamp created_on\n    }\n</code></pre>"},{"location":"SchemeArchitecture/#adding-a-new-scheme","title":"Adding a New Scheme","text":""},{"location":"SchemeArchitecture/#step-1-create-model","title":"Step 1: Create Model","text":"<p>Create <code>application/models/NewScheme.php</code>:</p> <pre><code>class Application_Model_NewScheme\n{\n    public function evaluate($shipmentResult, $shipmentId, $reEvaluate = false)\n    {\n        // Implement evaluation logic\n    }\n\n    public function generateNewSchemeExcelReport($shipmentId)\n    {\n        // Implement report generation\n    }\n}\n</code></pre>"},{"location":"SchemeArchitecture/#step-2-create-dbtable","title":"Step 2: Create DbTable","text":"<p>Create <code>application/models/DbTable/ResponseNewScheme.php</code>:</p> <pre><code>class Application_Model_DbTable_ResponseNewScheme extends Zend_Db_Table_Abstract\n{\n    protected $_name = 'response_result_newscheme';\n    protected $_primary = array('shipment_map_id', 'sample_id');\n\n    public function updateResults($params) { /* ... */ }\n}\n</code></pre>"},{"location":"SchemeArchitecture/#step-3-create-controller","title":"Step 3: Create Controller","text":"<p>Create <code>application/controllers/NewschemeController.php</code>:</p> <pre><code>class NewschemeController extends Zend_Controller_Action\n{\n    public function responseAction()\n    {\n        // Handle GET and POST\n    }\n}\n</code></pre>"},{"location":"SchemeArchitecture/#step-4-create-response-view","title":"Step 4: Create Response View","text":"<p>Create <code>application/views/scripts/newscheme/response.phtml</code></p>"},{"location":"SchemeArchitecture/#step-5-create-admin-partial","title":"Step 5: Create Admin Partial","text":"<p>Create <code>application/modules/admin/views/scripts/shipment/partials/schemes/newscheme.phtml</code></p>"},{"location":"SchemeArchitecture/#step-6-update-routers","title":"Step 6: Update Routers","text":"<p>Add to <code>get-sample-form.ajax.phtml</code>: <pre><code>} elseif ($this-&gt;scheme == 'newscheme') {\n    include('partials/schemes/newscheme.phtml');\n}\n</code></pre></p> <p>Add to <code>edit.phtml</code>: <pre><code>} elseif ($shipmentData['shipment']['scheme_type'] == 'newscheme') {\n    include dirname(__FILE__) . '/partials/schemes/newscheme.phtml';\n}\n</code></pre></p>"},{"location":"SchemeArchitecture/#step-7-update-service-layer","title":"Step 7: Update Service Layer","text":"<p>Add to <code>Shipments.php</code>: <pre><code>public function updateNewSchemeResults($data)\n{\n    // Implement result saving logic\n}\n</code></pre></p>"},{"location":"SchemeArchitecture/#step-8-create-database-tables","title":"Step 8: Create Database Tables","text":"<pre><code>CREATE TABLE reference_result_newscheme (\n    shipment_id INT,\n    sample_id VARCHAR(255),\n    -- scheme-specific fields\n    PRIMARY KEY (shipment_id, sample_id)\n);\n\nCREATE TABLE response_result_newscheme (\n    shipment_map_id INT,\n    sample_id VARCHAR(255),\n    -- scheme-specific fields\n    PRIMARY KEY (shipment_map_id, sample_id)\n);\n</code></pre>"},{"location":"SchemeArchitecture/#scheme-specific-details","title":"Scheme-Specific Details","text":""},{"location":"SchemeArchitecture/#dts-dried-tube-specimen","title":"DTS (Dried Tube Specimen)","text":"<ul> <li>Complexity: High (multiple algorithms, RTRI support, syphilis testing)</li> <li>Key Features:</li> <li>2 or 3 test panel configuration</li> <li>Multiple testing algorithms (Serial, Parallel, etc.)</li> <li>EIA/WB/Geenius modals for detailed results</li> <li>Optional syphilis and RTRI testing</li> <li>Algorithm-based scoring</li> </ul>"},{"location":"SchemeArchitecture/#vl-viral-load","title":"VL (Viral Load)","text":"<ul> <li>Complexity: High (quantitative analysis)</li> <li>Key Features:</li> <li>Z-score based evaluation</li> <li>Assay-specific range calculations</li> <li>TND (Target Not Detected) handling</li> <li>Log10 conversion support</li> <li>File upload for raw data</li> </ul>"},{"location":"SchemeArchitecture/#tb-tuberculosis","title":"TB (Tuberculosis)","text":"<ul> <li>Complexity: High (multiple assay types)</li> <li>Key Features:</li> <li>Molecular vs Microscopy test types</li> <li>GeneXpert MTB/RIF and Ultra support</li> <li>Rif resistance detection</li> <li>Probe values (A, B, C, D, E)</li> <li>Instrument tracking</li> <li>Draft save capability</li> </ul>"},{"location":"SchemeArchitecture/#eid-early-infant-diagnosis","title":"EID (Early Infant Diagnosis)","text":"<ul> <li>Complexity: Low (simplest scheme)</li> <li>Key Features:</li> <li>Binary result matching</li> <li>CT/OD value capture</li> <li>Extraction assay selection</li> </ul>"},{"location":"SchemeArchitecture/#recency","title":"Recency","text":"<ul> <li>Complexity: Medium</li> <li>Key Features:</li> <li>RTRI algorithm support</li> <li>Control/Verification/Longterm line interpretation</li> <li>Recency classification (Negative/Recent/Long-term)</li> </ul>"},{"location":"SchemeArchitecture/#covid-19","title":"COVID-19","text":"<ul> <li>Complexity: Medium</li> <li>Key Features:</li> <li>1-3 test platform support</li> <li>PCR reagent tracking</li> <li>Gene type identification</li> <li>Platform validation</li> </ul>"},{"location":"SchemeArchitecture/#dbs-dried-blood-spot","title":"DBS (Dried Blood Spot)","text":"<ul> <li>Complexity: Medium-High</li> <li>Key Features:</li> <li>Multiple EIA tests (up to 3)</li> <li>Western Blot with 9 protein bands</li> <li>OD and cutoff values</li> </ul>"},{"location":"SchemeArchitecture/#custom-tests","title":"Custom Tests","text":"<ul> <li>Complexity: Configurable</li> <li>Key Features:</li> <li>Supports qualitative and quantitative tests</li> <li>Configurable pass/fail thresholds</li> <li>Dynamic field configuration</li> <li>Custom test kit management</li> </ul>"},{"location":"SchemeArchitecture/#configuration","title":"Configuration","text":"<p>Scheme configuration is managed via <code>Pt_Commons_SchemeConfig::get('{scheme}')</code>:</p> <pre><code>$config = Pt_Commons_SchemeConfig::get('dts');\n// Returns: allowedAlgorithms, dtsSchemeType, rtriEnabled, etc.\n</code></pre> <p>Configuration sources: 1. Database: <code>scheme_list.user_test_config</code> (JSON) 2. System config files 3. Model defaults</p>"},{"location":"SchemeArchitecture/#shipment-lifecycle","title":"Shipment Lifecycle","text":"<pre><code>stateDiagram-v2\n    [*] --&gt; Draft: Create shipment\n    Draft --&gt; Ready: Add samples &amp; reference data\n    Ready --&gt; Shipped: Ship to participants\n    Shipped --&gt; ResponseCollection: Participants enter results\n    ResponseCollection --&gt; Evaluation: Admin triggers evaluation\n    Evaluation --&gt; Evaluated: Scores calculated\n    Evaluated --&gt; Finalized: Generate reports\n    Finalized --&gt; [*]\n\n    note right of ResponseCollection\n        Participants submit via\n        {scheme}/response.phtml\n    end note\n\n    note right of Evaluation\n        Model::evaluate() compares\n        responses vs reference\n    end note\n</code></pre>"},{"location":"SchemeArchitecture/#scoring-formula","title":"Scoring Formula","text":"<p>Most schemes follow this pattern:</p> <pre><code>flowchart LR\n    subgraph Input\n        CR[Correct Responses]\n        MP[Max Possible]\n        DI[Documentation Items]\n    end\n\n    subgraph Calculation\n        RS[\"Response Score&lt;br/&gt;(CR/MP) \u00d7 (100-Doc%)\"]\n        DS[\"Documentation Score&lt;br/&gt;Sum of item scores\"]\n    end\n\n    subgraph Output\n        FS[Final Score]\n        PF{Pass/Fail}\n    end\n\n    CR --&gt; RS\n    MP --&gt; RS\n    DI --&gt; DS\n    RS --&gt; FS\n    DS --&gt; FS\n    FS --&gt; PF\n    PF --&gt;|\"&gt;= Threshold\"| Pass\n    PF --&gt;|\"&lt; Threshold\"| Fail\n</code></pre> <p>Formula:</p> <pre><code>Response Score = (Correct Responses / Max Possible) \u00d7 (100 - Documentation%)\nDocumentation Score = Sum of documentation item scores\nFinal Score = Response Score + Documentation Score\nPass = Final Score &gt;= Passing Percentage (configurable per scheme)\n</code></pre>"},{"location":"SchemeArchitecture/#report-generation-excel-export","title":"Report Generation &amp; Excel Export","text":""},{"location":"SchemeArchitecture/#report-architecture","title":"Report Architecture","text":"<pre><code>flowchart TB\n    subgraph \"User Interface\"\n        A[Admin] --&gt; RC[Report Controllers]\n        RC --&gt; RV[Report Views]\n    end\n\n    subgraph \"Service Layer\"\n        RC --&gt; RS[Reports Service]\n        RS --&gt; ES[Evaluation Service]\n    end\n\n    subgraph \"Model Layer\"\n        RS --&gt; DM[\"{Scheme} Model\"]\n        DM --&gt; GER[\"generate{Scheme}ExcelReport()\"]\n        DM --&gt; GDP[\"getDataFor{Type}PDF()\"]\n    end\n\n    subgraph \"Output\"\n        GER --&gt; XLSX[Excel .xlsx]\n        GDP --&gt; PDF[PDF Reports]\n        XLSX --&gt; ZIP[ZIP Archive]\n        PDF --&gt; ZIP\n    end\n</code></pre>"},{"location":"SchemeArchitecture/#excel-report-methods-by-scheme","title":"Excel Report Methods by Scheme","text":"<p>Each scheme model has a dedicated Excel report generation method:</p> Scheme Model Method Output DTS <code>generateDtsRapidHivExcelReport($shipmentId)</code> Multi-sheet XLSX with test results, scores VL <code>generateDtsViralLoadExcelReport($shipmentId)</code> Participant details, assay results, Z-scores TB <code>generateTbExcelReport($shipmentId)</code> Participant list, MTB/RIF results EID <code>generateDbsEidExcelReport($shipmentId)</code> EID PT results, assay info Recency <code>generateRecencyExcelReport($shipmentId)</code> Lab info, recency PT results COVID-19 <code>generateCovid19ExcelReport($shipmentId)</code> Instructions, test types, responses Custom Tests <code>generateGenericTestExcelReport($shipmentId, $schemeType)</code> Participant list, test responses"},{"location":"SchemeArchitecture/#pdf-generation-methods","title":"PDF Generation Methods","text":"<p>Some schemes support individual and summary PDF reports:</p> Scheme Individual PDF Summary PDF TB <code>getDataForIndividualPDFBatch($mapIds)</code> <code>getDataForSummaryPDF($shipmentId)</code> VL <code>getDataForIndividualPDFBatch($shipmentId, $mapIds, $attributes)</code> - Custom Tests - <code>getDataForSummaryPDF($shipmentId)</code>"},{"location":"SchemeArchitecture/#report-controllers","title":"Report Controllers","text":"<p>Located in <code>application/modules/reports/controllers/</code>:</p> Controller Key Actions Purpose <code>ShipmentsController</code> <code>indexAction</code>, <code>shipmentsExportAction</code> Shipment overview reports <code>ShipmentResponseController</code> <code>indexAction</code>, <code>shipmentsExportPdfAction</code> Response reports <code>FinalizeController</code> <code>shipmentsAction</code>, <code>sendReportMailAction</code> Finalized reports <code>ParticipantPerformanceController</code> <code>indexAction</code>, <code>exportAction</code> Performance analytics <code>ParticipantTrendsController</code> <code>indexAction</code> Trend analysis <code>CorrectiveActionsController</code> <code>indexAction</code> Corrective action reports <code>TbResultsController</code> <code>indexAction</code> TB-specific results <code>TbAllSitesResultsController</code> <code>indexAction</code> Multi-site TB reports"},{"location":"SchemeArchitecture/#report-service-applicationservicesreportsphp","title":"Report Service (<code>application/services/Reports.php</code>)","text":"<p>Central orchestration for report generation:</p> <pre><code>// Route to scheme-specific Excel generation\npublic function getShipmentParticipant($shipmentId, $schemeType = null)\n{\n    switch ($schemeType) {\n        case 'dts': return $this-&gt;dtsModel-&gt;generateDtsRapidHivExcelReport($shipmentId);\n        case 'vl': return $this-&gt;vlModel-&gt;generateDtsViralLoadExcelReport($shipmentId);\n        case 'tb': return $this-&gt;tbModel-&gt;generateTbExcelReport($shipmentId);\n        // ... etc\n    }\n}\n\n// Generate overview report\npublic function exportShipmentsReport($params)\n{\n    // Creates \"Shipment Response Overview\" Excel\n    // Columns: scheme, shipment code, sample label, responses, pass rates\n}\n</code></pre>"},{"location":"SchemeArchitecture/#report-flow","title":"Report Flow","text":"<pre><code>sequenceDiagram\n    participant A as Admin\n    participant RC as ReportController\n    participant RS as Reports Service\n    participant M as {Scheme} Model\n    participant DB as Database\n    participant F as File System\n\n    A-&gt;&gt;RC: Request report (shipmentsExportAction)\n    RC-&gt;&gt;RS: getShipmentParticipant($shipmentId, $scheme)\n    RS-&gt;&gt;M: generate{Scheme}ExcelReport($shipmentId)\n    M-&gt;&gt;DB: Fetch participant data\n    M-&gt;&gt;DB: Fetch response data\n    M-&gt;&gt;DB: Fetch reference data\n    DB--&gt;&gt;M: Data\n    M-&gt;&gt;M: Build Excel with PhpSpreadsheet\n    M-&gt;&gt;F: Save .xlsx to temp\n    F--&gt;&gt;RC: File path\n    RC-&gt;&gt;A: Download file\n</code></pre>"},{"location":"SchemeArchitecture/#file-output-locations","title":"File Output Locations","text":"Type Path Example Temp exports <code>TEMP_UPLOAD_PATH/</code> <code>shipment-response-1706284800.xlsx</code> Summary PDFs <code>/downloads/reports/{code}/</code> <code>DTS-2024-01-summary.pdf</code> Individual PDFs <code>/downloads/reports/{code}/</code> <code>DTS-2024-01-{participant}.pdf</code> ZIP archives <code>/downloads/reports/</code> <code>DTS-2024-01.zip</code> TB Forms <code>TEMP_UPLOAD_PATH/</code> <code>DTS-2024-01-TB-FORMS.zip</code>"},{"location":"SchemeArchitecture/#excel-report-structure-example-dts","title":"Excel Report Structure (Example: DTS)","text":"<pre><code>DTS-Shipment-Report.xlsx\n\u251c\u2500\u2500 Sheet 1: Instructions\n\u2502   \u2514\u2500\u2500 Tab descriptions, color coding legend\n\u251c\u2500\u2500 Sheet 2: Participant List\n\u2502   \u2514\u2500\u2500 Lab ID, Name, Country, Region, Site Type\n\u251c\u2500\u2500 Sheet 3: PT Results\n\u2502   \u2514\u2500\u2500 Sample, Test 1/2/3 Results, Final Result, Score\n\u251c\u2500\u2500 Sheet 4: Panel Score\n\u2502   \u2514\u2500\u2500 Per-sample scoring breakdown\n\u251c\u2500\u2500 Sheet 5: Documentation Score\n\u2502   \u2514\u2500\u2500 Receipt date, rehydration, testing date scores\n\u2514\u2500\u2500 Sheet 6: Total Score\n    \u2514\u2500\u2500 Response + Documentation = Final Score, Pass/Fail\n</code></pre>"},{"location":"SchemeArchitecture/#supported-export-formats","title":"Supported Export Formats","text":"Format Library Use Case Excel (.xlsx) PhpOffice\\PhpSpreadsheet Detailed data export, analysis PDF TCPDF/Custom Individual certificates, summaries ZIP ZipArchive Bulk downloads, all reports bundled"},{"location":"SchemeArchitecture/#adding-reports-for-new-scheme","title":"Adding Reports for New Scheme","text":"<ol> <li> <p>Add Excel method to Model: <pre><code>public function generateNewSchemeExcelReport($shipmentId)\n{\n    $excel = new Spreadsheet();\n    // Build sheets...\n    $writer = IOFactory::createWriter($excel, 'Xlsx');\n    $filename = 'newscheme-' . $shipmentId . '.xlsx';\n    $writer-&gt;save(TEMP_UPLOAD_PATH . '/' . $filename);\n    return $filename;\n}\n</code></pre></p> </li> <li> <p>Add to Reports Service: <pre><code>case 'newscheme':\n    return $this-&gt;newSchemeModel-&gt;generateNewSchemeExcelReport($shipmentId);\n</code></pre></p> </li> <li> <p>Add PDF support (optional): <pre><code>public function getDataForIndividualPDFBatch($mapIds)\n{\n    // Fetch data for PDF generation\n}\n</code></pre></p> </li> </ol>"},{"location":"SchemeArchitecture/#related-documentation","title":"Related Documentation","text":"<ul> <li>Admin Shipment Forms</li> <li>Database migrations in <code>/database/migrations/</code></li> <li>API documentation for external integrations</li> </ul>"},{"location":"TranslationGuide/","title":"ePT Translation Guide","text":"<p>This guide provides standards and terminology for translating the ePT (e-Proficiency Testing) platform. It ensures consistency across all language translations with proper context for medical/laboratory terminology.</p>"},{"location":"TranslationGuide/#project-context","title":"Project Context","text":"<p>ePT is a medical proficiency testing platform for laboratory quality assurance. It enables organizations to:</p> <ul> <li>Create and manage PT (Proficiency Testing) shipments</li> <li>Enroll participant laboratories and track their responses</li> <li>Evaluate results against reference data</li> <li>Generate reports for analysis and certification</li> </ul>"},{"location":"TranslationGuide/#critical-context","title":"Critical Context","text":"<p>\"PT\" = Proficiency Testing (laboratory quality assurance testing)</p> <p>PT does NOT mean: - Physical Therapy - Physiotherapy - Patient - Part-Time</p> <p>Always translate PT in the context of laboratory quality control and testing proficiency.</p>"},{"location":"TranslationGuide/#core-terminology","title":"Core Terminology","text":""},{"location":"TranslationGuide/#platform-concepts","title":"Platform Concepts","text":"English Term Definition Translation Notes Proficiency Testing (PT) A program where laboratories test unknown samples to assess their testing accuracy Core concept - never confuse with medical therapy PT Program An organized testing program managed through the platform The main organizational unit PT Manager Administrator role managing PT programs A user role, not a software feature Scheme A category of tests (e.g., HIV, TB, COVID-19) Use \"program\" or \"testing program\" sense, not \"diagram\" Shipment A batch of samples sent to participating laboratories Physical delivery of test materials Round A testing cycle within a scheme Time-based testing period Panel A set of samples within a shipment Collection of test specimens Participant An enrolled laboratory taking part in PT Not an individual person, but a lab/facility"},{"location":"TranslationGuide/#test-schemes-abbreviations","title":"Test Schemes (Abbreviations)","text":"<p>Keep abbreviations in English, but translate the full names:</p> Abbreviation Full Name Context DTS Dried Tube Specimen HIV Serology rapid testing VL Viral Load HIV quantitative testing EID Early Infant Diagnosis PCR-based infant HIV testing TB Tuberculosis Molecular and microscopy testing Recency HIV Recency Testing Recent infection detection COVID-19 Coronavirus Disease 2019 Keep as \"COVID-19\" in all languages DBS Dried Blood Spot EIA and Western Blot testing"},{"location":"TranslationGuide/#laboratory-testing-terms","title":"Laboratory &amp; Testing Terms","text":"English Definition Laboratory Facility performing the tests Sample / Specimen Material being tested Result Test outcome Reference Result The correct/expected result Reported Result What the participant laboratory submitted Concordance Agreement between reported and reference results Discordance Disagreement between reported and reference results Score Numerical evaluation of performance Evaluation Assessment of laboratory performance Algorithm Testing procedure/workflow Assay A test or testing procedure Reagent Chemical substance used in testing"},{"location":"TranslationGuide/#user-interface-terms","title":"User Interface Terms","text":"English Usage Context Download Retrieving files from server Upload Sending files to server Submit Sending form data / responses Save Storing changes Cancel Aborting an action Delete Removing permanently Edit Modifying existing data View Displaying without editing Report Generated document with results Dashboard Overview/summary page Settings Configuration options Establishment Institution/facility (use formal term)"},{"location":"TranslationGuide/#user-roles","title":"User Roles","text":"English Context Administrator Full system access Admin Abbreviated form of Administrator Data Manager Manages participant data Participant Laboratory user submitting results User Generic system user"},{"location":"TranslationGuide/#status-terms","title":"Status Terms","text":"English Context Pending Waiting for action In Progress Currently being processed Completed Finished successfully Active Currently enabled Inactive Currently disabled Approved Accepted/validated Rejected Declined/invalid Finalized Locked and complete Shipped Samples sent to participants Evaluated Results have been assessed"},{"location":"TranslationGuide/#translation-rules","title":"Translation Rules","text":""},{"location":"TranslationGuide/#1-preserve-technical-elements","title":"1. Preserve Technical Elements","text":"<p>Never translate or modify: - Variable placeholders: <code>%s</code>, <code>%d</code>, <code>%1$s</code>, <code>{0}</code>, <code>{{name}}</code> - HTML tags: <code>&lt;strong&gt;</code>, <code>&lt;br&gt;</code>, <code>&lt;a href=\"...\"&gt;</code> - Email addresses and URLs - Code/technical identifiers</p> <p>Example: <pre><code>Source: \"Hello %s, you have %d messages\"\nTranslation: \"[Greeting] %s, [you have] %d [messages]\"\n</code></pre></p>"},{"location":"TranslationGuide/#2-maintain-placeholder-order","title":"2. Maintain Placeholder Order","text":"<p>Some languages require different word order. Use positional placeholders when reordering: <pre><code>Source: \"%s uploaded %d files\"\nTranslation (if reordering needed): \"%2$d [files uploaded by] %1$s\"\n</code></pre></p>"},{"location":"TranslationGuide/#3-context-over-literal-translation","title":"3. Context Over Literal Translation","text":"<p>Translate meaning, not words: - \"No. of Responses\" = \"Number of Responses\" = [Count of responses submitted] - \"PT Manager\" = [Person who manages proficiency testing programs]</p>"},{"location":"TranslationGuide/#4-consistency","title":"4. Consistency","text":"<p>Use the same translation for the same term throughout: - Pick ONE translation for \"Email\" and use it everywhere - Pick ONE translation for \"Scheme\" and use it everywhere - Document your choices in language-specific notes</p>"},{"location":"TranslationGuide/#5-formality","title":"5. Formality","text":"<p>Use formal register throughout the application: - Use formal \"you\" forms where applicable (vous, Sie, usted, etc.) - Use professional/technical language - Avoid slang or colloquialisms</p>"},{"location":"TranslationGuide/#6-completeness","title":"6. Completeness","text":"<ul> <li>Never leave <code>msgstr</code> empty for strings that need translation</li> <li>Translate the complete meaning, including implied articles/prepositions</li> <li>Match the tone and intent of the original</li> </ul>"},{"location":"TranslationGuide/#common-mistakes","title":"Common Mistakes","text":""},{"location":"TranslationGuide/#1-wrong-context-for-pt","title":"1. Wrong Context for \"PT\"","text":"Wrong Correct Physical Therapy Proficiency Testing Physiotherapy Proficiency Testing Patient (PT never means Patient here)"},{"location":"TranslationGuide/#2-wrong-context-for-scheme","title":"2. Wrong Context for \"Scheme\"","text":"Wrong Correct Diagram/Blueprint Testing Program/Category Plan/Plot Testing Program/Category"},{"location":"TranslationGuide/#3-wrong-context-for-panel","title":"3. Wrong Context for \"Panel\"","text":"Wrong Correct UI Panel/Section Set of test samples Control Panel Set of test samples"},{"location":"TranslationGuide/#4-placeholder-errors","title":"4. Placeholder Errors","text":"Wrong Correct Removing <code>%s</code> Keep <code>%s</code> exactly Translating <code>%d</code> Keep <code>%d</code> exactly Changing <code>{name}</code> to <code>{nom}</code> Keep <code>{name}</code> exactly"},{"location":"TranslationGuide/#quality-checklist","title":"Quality Checklist","text":"<p>Before submitting translations:</p> <ul> <li>[ ] All strings have translations (no empty <code>msgstr</code>)</li> <li>[ ] Placeholders preserved exactly (<code>%s</code>, <code>%d</code>, <code>{0}</code>, etc.)</li> <li>[ ] HTML tags preserved exactly</li> <li>[ ] \"PT\" translated as Proficiency Testing, not therapy</li> <li>[ ] \"Scheme\" translated as testing program, not diagram</li> <li>[ ] Terminology consistent throughout the file</li> <li>[ ] Formal register used (formal \"you\")</li> <li>[ ] No trailing or leading spaces in translations</li> <li>[ ] Proper punctuation and capitalization for target language</li> <li>[ ] Accents and special characters correct for target language</li> </ul>"},{"location":"TranslationGuide/#file-format","title":"File Format","text":""},{"location":"TranslationGuide/#po-file-structure","title":"PO File Structure","text":"<p>Translation files use GNU gettext format (<code>.po</code>):</p> <pre><code># Comment providing context\n#: path/to/source/file.php:123\nmsgid \"Original English text\"\nmsgstr \"Translated text\"\n</code></pre> <ul> <li><code>msgid</code>: Source text (DO NOT MODIFY)</li> <li><code>msgstr</code>: Your translation</li> <li><code>#:</code> Reference to source file location</li> <li><code>#</code> Comments provide context</li> </ul>"},{"location":"TranslationGuide/#plural-forms","title":"Plural Forms","text":"<p>Handle plurals according to target language rules:</p> <pre><code>msgid \"1 result\"\nmsgid_plural \"%d results\"\nmsgstr[0] \"singular form\"\nmsgstr[1] \"plural form\"\n</code></pre> <p>Note: Some languages have more than 2 plural forms (e.g., Russian, Arabic).</p>"},{"location":"TranslationGuide/#adding-a-new-language","title":"Adding a New Language","text":"<ol> <li>Copy <code>application/languages/en_US/en_US.po</code> as template</li> <li>Create new directory: <code>application/languages/{locale}/{locale}.po</code></li> <li>Update the PO file header with language metadata</li> <li>Translate all <code>msgstr</code> entries</li> <li>Run quality checks using this guide</li> <li>Test in the application</li> </ol>"},{"location":"TranslationGuide/#language-specific-notes","title":"Language-Specific Notes","text":""},{"location":"TranslationGuide/#french-fr_fr","title":"French (fr_FR)","text":"<ul> <li>Use formal \"vous\" throughout</li> <li>Include articles: \"G\u00e9n\u00e9rer les rapports\" not \"G\u00e9n\u00e9rer rapports\"</li> <li>Use proper accents: \u00c9, \u00e8, \u00ea, \u00e7, \u00e0</li> <li>\"Email\" \u2192 \"Courriel\" or \"E-mail\" (pick one)</li> </ul>"},{"location":"TranslationGuide/#spanish-es_es","title":"Spanish (es_ES)","text":"<ul> <li>Use formal \"usted\" throughout</li> <li>\"Email\" \u2192 \"Correo electr\u00f3nico\"</li> </ul>"},{"location":"TranslationGuide/#portuguese-pt_br-pt_pt","title":"Portuguese (pt_BR / pt_PT)","text":"<ul> <li>Distinguish Brazilian vs European Portuguese</li> <li>Use formal register</li> </ul> <p>(Add notes for other languages as needed)</p>"},{"location":"TranslationGuide/#contact","title":"Contact","text":"<p>For translation questions or to report issues:</p> <p>GitHub: deforay/ept</p>"},{"location":"training/","title":"ePT Training Curriculum","text":""},{"location":"training/#about-this-training","title":"About This Training","text":"<p>What is ePT? A web-based application used by PT Providers to manage the Proficiency Testing lifecycle \u2014 from creating surveys and enrolling participants, to evaluating results and generating reports.</p> <p>Who is this for? Trainers and PT Managers who will manage the PT program or conduct step-down trainings. The Participant section (Part 3) can be delivered as a standalone module for participant-only step-down training.</p> <p>Duration: 30\u201345 minutes total</p>"},{"location":"training/#curriculum","title":"Curriculum","text":"Part Topic Audience Duration Part 1 System Setup &amp; Participant Management Admin ~10 min Part 2 PT Survey &amp; Shipment Management Admin ~10 min Part 3 Participant \u2014 Result Submission &amp; Reports Participant ~5\u201310 min Part 4 Evaluation, Reports &amp; Finalization Admin ~10 min <p>For step-down participant training: Deliver only Part 3. It is self-contained and covers everything a participant needs to know.</p>"},{"location":"training/#exercises","title":"Exercises","text":"<p>Hands-on exercises to follow along during or after the training:</p> <ul> <li>DTS HIV Serology</li> </ul>"},{"location":"training/#quick-reference-full-pt-lifecycle","title":"Quick Reference: Full PT Lifecycle","text":"<pre><code>1. Add Participants          \u2192  Configure \u2192 PT Participants\n2. Enroll in Scheme          \u2192  Configure \u2192 Scheme Enrollments\n3. Create PT Survey          \u2192  Manage \u2192 PT Survey \u2192 Add\n4. Add Shipment + Samples    \u2192  PT Survey \u2192 Add Scheme\n5. Enroll in Shipment        \u2192  Shipment \u2192 Enroll\n6. Ship PT Survey            \u2192  Manage \u2192 PT Survey \u2192 Ship Now\n7. Participants Submit       \u2192  Participant Portal \u2192 PT Result Submission\n8. Evaluate                  \u2192  Analyze \u2192 Evaluate Responses\n9. Generate Reports          \u2192  Analyze \u2192 Generate Reports\n10. Finalize                 \u2192  Analyze \u2192 Finalize Reports\n11. Download Reports         \u2192  Reports \u2192 Shipment Reports (Admin)\n                                View PT Results \u2192 Individual Reports (Participant)\n</code></pre>"},{"location":"training/#delivering-this-training","title":"Delivering This Training","text":"Scenario What to cover Duration Full training for PT Managers / Trainers Parts 1\u20134 30\u201345 min Step-down training for participants only Part 3 only 5\u201310 min Refresher for existing admins Parts 2 + 4 (survey management + evaluation) 15\u201320 min <p>Recommended approach: - Use a test/training instance of ePT - Follow along with the exercises for hands-on practice - Have participants complete the exercise during or immediately after the training</p>"},{"location":"training/part1-setup-and-participants/","title":"Part 1: System Setup &amp; Participant Management (~10 min)","text":"<p>\u2190 Back to Curriculum | Next: Part 2 \u2014 PT Survey &amp; Shipment Management \u2192</p> <p>Audience: Admin</p> <p>Objective: Understand the admin interface and how to add and enroll participants.</p>"},{"location":"training/part1-setup-and-participants/#11-logging-in-dashboard-overview","title":"1.1 Logging In &amp; Dashboard Overview","text":"<ul> <li>Navigate to the admin login page</li> <li>Log in with PT Administrator / PT Manager credentials</li> <li>Quick tour of the dashboard and left-side menu:</li> <li>Configure \u2014 system settings, participants, enrollments</li> <li>Manage \u2014 PT Surveys</li> <li>Analyze \u2014 evaluation, reports, finalization</li> <li>Reports \u2014 shipment and performance reports</li> </ul>"},{"location":"training/part1-setup-and-participants/#12-adding-participants","title":"1.2 Adding Participants","text":"<p>Single participant: - Go to Configure \u2192 PT Participants \u2192 Add - Fill in required fields (name, unique identifier, contact details) - Save</p> <p>Bulk import (recommended for large groups): - Go to Configure \u2192 PT Participants \u2192 Bulk Import Participants - Download the Excel template (link on the right side of the page) - Fill in participant details \u2014 fields with red headings are required - Password can be left blank (system will auto-generate) or set manually - Upload the completed file</p>"},{"location":"training/part1-setup-and-participants/#13-scheme-enrollment","title":"1.3 Scheme Enrollment","text":"<ul> <li>Go to Configure \u2192 Scheme Enrollments</li> <li>Select the scheme type from the dropdown (e.g., HIV Serology)</li> <li>Click on the relevant scheme enrollment link</li> <li>Move participants from the Available list (left) to the Enrolled list (right)</li> <li>Click Enroll Selected to save</li> </ul> <p>Key concept: Participants must be enrolled in a scheme before they can be enrolled in individual shipments under that scheme.</p>"},{"location":"training/part1-setup-and-participants/#trainer-notes","title":"Trainer Notes","text":"<ul> <li>Have participant data ready in the Excel template before the session</li> <li>Emphasize the difference between scheme enrollment (one-time setup) and shipment enrollment (per-survey)</li> <li>If the deployment uses Data Managers, briefly explain that each participant needs at least one Data Manager assigned (Configure \u2192 Data Managers)</li> </ul> <p>\u2190 Back to Curriculum | Next: Part 2 \u2014 PT Survey &amp; Shipment Management \u2192</p>"},{"location":"training/part2-surveys-and-shipments/","title":"Part 2: PT Survey &amp; Shipment Management (~10 min)","text":"<p>\u2190 Part 1: Setup &amp; Participants | Back to Curriculum | Next: Part 3 \u2014 Participant \u2192</p> <p>Audience: Admin</p> <p>Objective: Create a PT Survey, add shipments with sample data, enroll participants, and ship.</p>"},{"location":"training/part2-surveys-and-shipments/#21-create-a-pt-survey","title":"2.1 Create a PT Survey","text":"<ul> <li>Go to Manage \u2192 PT Survey</li> <li>Click Add New PT Survey</li> <li>Enter a PT Survey Code (letters, numbers, and hyphens only)</li> <li>Select the PT Survey Date</li> <li>Click Add</li> </ul>"},{"location":"training/part2-surveys-and-shipments/#22-add-a-shipment-scheme","title":"2.2 Add a Shipment (Scheme)","text":"<ul> <li>From the PT Survey list, click Add Scheme next to your new survey</li> <li>Select the scheme from the dropdown (e.g., Dried Tube Specimen - HIV Serology)</li> <li>Scroll down and configure:</li> <li>Shipment Code \u2014 auto-generated, can be customized</li> <li>Result Due Date \u2014 deadline for participant submissions</li> <li>Samples \u2014 add 3\u20135 samples using the +Sample/Control button, and set expected results for each</li> <li>Click Add Shipment</li> </ul>"},{"location":"training/part2-surveys-and-shipments/#23-enroll-participants-to-the-shipment","title":"2.3 Enroll Participants to the Shipment","text":"<ul> <li>From the shipment list, click the Enroll button (red)</li> <li>Move participants from the Available list to the Enrolled list</li> <li>Click Enroll to save</li> </ul> <p>Note: Only participants who are already enrolled in the scheme (Part 1, Step 1.3) will appear in the available list.</p>"},{"location":"training/part2-surveys-and-shipments/#24-ship-the-pt-survey","title":"2.4 Ship the PT Survey","text":"<ul> <li>Go to Manage \u2192 PT Survey</li> <li>Find your survey in the table</li> <li>Click Ship Now</li> <li>Confirm when prompted</li> </ul> <p>What happens when you ship? The survey becomes visible to enrolled participants. They can now log in and submit results. No further structural changes should be made after shipping.</p>"},{"location":"training/part2-surveys-and-shipments/#trainer-notes","title":"Trainer Notes","text":"<ul> <li>Demonstrate one complete cycle: create survey \u2192 add shipment \u2192 enroll \u2192 ship</li> <li>Highlight that a single PT Survey can contain multiple shipments (different schemes)</li> <li>Emphasize that shipping is the trigger \u2014 nothing is visible to participants until this step</li> </ul> <p>\u2190 Part 1: Setup &amp; Participants | Back to Curriculum | Next: Part 3 \u2014 Participant \u2192</p>"},{"location":"training/part3-participant/","title":"Part 3: Participant \u2014 Result Submission &amp; Reports (~5\u201310 min)","text":"<p>\u2190 Part 2: Surveys &amp; Shipments | Back to Curriculum | Next: Part 4 \u2014 Evaluation &amp; Reports \u2192</p> <p>Audience: Participant</p> <p>This part can be delivered standalone for participant step-down training.</p> <p>Objective: Log in as a participant, submit PT results, and download finalized reports.</p>"},{"location":"training/part3-participant/#31-logging-in","title":"3.1 Logging In","text":"<ul> <li>Navigate to the Participant Login page</li> <li>Enter username and password (provided by the PT Provider)</li> <li>Log in</li> </ul>"},{"location":"training/part3-participant/#32-submitting-results","title":"3.2 Submitting Results","text":"<ul> <li>Click PT Result Submission from the menu</li> <li>Find the shipment in the list (look for the shipment code and due date)</li> <li>Click Enter Result</li> <li>Fill in the result form:</li> <li>Select test kits used for each test</li> <li>Enter results for each sample</li> <li>Provide final interpretation</li> <li>Fill in any documentation fields (lot numbers, expiry dates, etc.)</li> <li>Click Submit</li> </ul> <p>Important: Results must be submitted before the Result Due Date. Late submissions may not be accepted.</p>"},{"location":"training/part3-participant/#33-downloading-reports-after-finalization","title":"3.3 Downloading Reports (After Finalization)","text":"<ul> <li>Once the PT Provider has finalized the shipment, reports become available</li> <li>Go to View PT Results \u2192 Individual Reports</li> <li>Search for the shipment and download the report</li> </ul>"},{"location":"training/part3-participant/#trainer-notes","title":"Trainer Notes","text":"<ul> <li>For step-down participant training, start here \u2014 no admin context needed</li> <li>Walk through at least one full result entry live</li> <li>Point out the due date and stress timely submission</li> <li>Reports are only available after the admin finalizes (Part 4) \u2014 set expectations accordingly</li> </ul> <p>\u2190 Part 2: Surveys &amp; Shipments | Back to Curriculum | Next: Part 4 \u2014 Evaluation &amp; Reports \u2192</p>"},{"location":"training/part4-evaluation-and-reports/","title":"Part 4: Evaluation, Reports &amp; Finalization (~10 min)","text":"<p>\u2190 Part 3: Participant | Back to Curriculum</p> <p>Audience: Admin</p> <p>Objective: Evaluate participant responses, generate reports, finalize the shipment, and review performance.</p>"},{"location":"training/part4-evaluation-and-reports/#41-evaluate-responses","title":"4.1 Evaluate Responses","text":"<ul> <li>Go to Analyze \u2192 Evaluate Responses</li> <li>Find your shipment (use the search box)</li> <li>Click View</li> <li>Scroll to the bottom and click the green Evaluate button</li> <li>Review the results table \u2014 each participant's score and pass/fail status is shown</li> </ul> <p>Note: Evaluation can be run multiple times. Results are not visible to participants until finalization.</p>"},{"location":"training/part4-evaluation-and-reports/#42-generate-reports","title":"4.2 Generate Reports","text":"<ul> <li>Go to Analyze \u2192 Generate Reports</li> <li>Find your shipment and click View</li> <li>Scroll down and click the green Report button</li> <li>Click Generate Participant Reports</li> <li>Wait a moment and refresh \u2014 reports are generated in the background</li> </ul>"},{"location":"training/part4-evaluation-and-reports/#43-finalize-the-shipment","title":"4.3 Finalize the Shipment","text":"<ul> <li>Go to Analyze \u2192 Finalize Reports</li> <li>Find your shipment and click View</li> <li>Scroll down and click the green Finalize button</li> <li>Click Generate Reports and Finalize Shipment</li> <li>Wait a moment and refresh</li> </ul> <p>Important: Finalization is permanent. Once finalized, participants can download their reports. Ensure evaluation and reports are correct before finalizing.</p>"},{"location":"training/part4-evaluation-and-reports/#44-review-performance-shipment-report","title":"4.4 Review Performance (Shipment Report)","text":"<ul> <li>Go to Reports \u2192 Shipment Reports</li> <li>Find your shipment and click the green shipment code link</li> <li>An Excel file is downloaded with multiple sheets showing overall and per-participant performance</li> </ul>"},{"location":"training/part4-evaluation-and-reports/#trainer-notes","title":"Trainer Notes","text":"<ul> <li>Walk through the full evaluate \u2192 generate \u2192 finalize flow live</li> <li>Emphasize that evaluate and generate can be repeated, but finalize cannot be undone</li> <li>After finalizing, switch to a participant login to show that reports are now downloadable (ties back to Part 3, Step 3.3)</li> </ul> <p>\u2190 Part 3: Participant | Back to Curriculum</p>"},{"location":"training/exercises/dts-hiv-serology/","title":"Exercise: DTS HIV Serology","text":"<p>This exercise walks through a complete PT cycle for the Dried Tube Specimen (DTS) - HIV Serology scheme. By the end, you will have created a PT Survey, enrolled participants, collected results, evaluated responses, and generated final reports.</p> <p>Scheme: Dried Tube Specimen (DTS) - HIV Serology</p> <p>Time required: 20\u201330 minutes</p> <p>Prerequisites: - Access to a training/test instance of ePT - Admin login credentials (PT Administrator or PT Manager) - The participant bulk import Excel template (downloaded in Step 1)</p>"},{"location":"training/exercises/dts-hiv-serology/#exercise-overview","title":"Exercise Overview","text":"Step Action Role 1 Add 8 new participants (bulk import) Admin 2 Enroll participants in the HIV Serology scheme Admin 3 Create a new PT Survey Admin 4 Add a DTS HIV Serology shipment with samples Admin 5 Enroll participants in the shipment Admin 6 Ship the PT Survey Admin 7 Submit results as participants Participant 8 Evaluate, generate reports, and finalize Admin 9 Review performance reports Admin 10 Download reports as a participant Participant"},{"location":"training/exercises/dts-hiv-serology/#admin-section","title":"Admin Section","text":""},{"location":"training/exercises/dts-hiv-serology/#step-1-add-new-participants-bulk-import","title":"Step 1: Add New Participants (Bulk Import)","text":"<ol> <li>Log in as PT Administrator / PT Manager</li> <li>Go to Configure \u2192 PT Participants</li> <li>Click Bulk Import Participants</li> <li>Download the Excel template by clicking the link on the right side of the page</li> <li>Open the file and fill in details for 8 new participants:</li> <li>Fields with red headings are required (Participant ID, Name, etc.)</li> <li>Use a naming convention you can recognize later, e.g. <code>TRAIN-001</code> through <code>TRAIN-008</code></li> <li>You may leave the password field blank (the system will auto-generate) or set a password you will remember for Step 7</li> <li>Save the Excel file and upload it on the same page</li> <li>Verify the participants appear in the PT Participants list</li> </ol> <p>Tip: If you set a custom password, use the same one for all 8 participants \u2014 this makes Step 7 much faster. Note down the Participant IDs and passwords for later use.</p>"},{"location":"training/exercises/dts-hiv-serology/#step-2-enroll-participants-in-the-scheme","title":"Step 2: Enroll Participants in the Scheme","text":"<p>Scheme enrollment is a one-time setup. Participants must be enrolled in the HIV Serology scheme before they can be enrolled in any DTS shipment.</p> <ol> <li>Go to Configure \u2192 Scheme Enrollments</li> <li>Select HIV Serology from the scheme type dropdown</li> <li>Click on Enroll the Participants for Dried Tube Specimen - HIV Serology</li> <li>Select your 8 new participants from the Available list (left) and move them to the Enrolled list (right)</li> <li>Click Enroll Selected</li> </ol> <p>Don't see your participants? Make sure you uploaded the file in Step 1 and that the participants are in Active status. Check Configure \u2192 PT Participants to verify.</p>"},{"location":"training/exercises/dts-hiv-serology/#step-3-create-a-new-pt-survey","title":"Step 3: Create a New PT Survey","text":"<ol> <li>Go to Manage \u2192 PT Survey</li> <li>Click Add New PT Survey</li> <li>Enter a PT Survey Code (e.g., <code>TRAIN-2026-01</code>) \u2014 letters, numbers, and hyphens only</li> <li>Select today's date as the PT Survey Date</li> <li>Click Add</li> </ol>"},{"location":"training/exercises/dts-hiv-serology/#step-4-add-a-dts-hiv-serology-shipment","title":"Step 4: Add a DTS HIV Serology Shipment","text":"<ol> <li>Your new PT Survey should appear in the list \u2014 click Add Scheme</li> <li>Select Dried Tube Specimen - HIV Serology from the dropdown</li> <li>Scroll down and configure:</li> <li>Shipment Code \u2014 keep the default or customize it</li> <li>Result Due Date \u2014 set a date at least a few days from now</li> <li>Samples \u2014 add 5 samples using the +Sample/Control button</li> <li>For each sample, set the expected reference result. Use a mix so participants can be properly evaluated:</li> </ol> Sample Suggested Expected Result Sample 1 HIV Positive Sample 2 HIV Negative Sample 3 HIV Positive Sample 4 HIV Negative Sample 5 HIV Positive <ol> <li>Click Add Shipment</li> </ol> <p>About DTS samples: In HIV Serology, participants test each sample using the national testing algorithm (typically Test-1 screening, then confirmatory Test-2 and Test-3 as needed). The expected result is the final interpretation for each sample.</p>"},{"location":"training/exercises/dts-hiv-serology/#step-5-enroll-participants-in-the-shipment","title":"Step 5: Enroll Participants in the Shipment","text":"<ol> <li>Your new shipment should appear in the list \u2014 click the red Enroll button</li> <li>Select all 8 participants from the Available list and move them to the Enrolled list</li> <li>Click Enroll</li> </ol> <p>Don't see your participants? They must already be enrolled in the HIV Serology scheme (Step 2). Go back and check if needed.</p>"},{"location":"training/exercises/dts-hiv-serology/#step-6-ship-the-pt-survey","title":"Step 6: Ship the PT Survey","text":"<ol> <li>Go to Manage \u2192 PT Survey</li> <li>Find your PT Survey in the table (it should be near the top)</li> <li>Click Ship Now</li> <li>Confirm by clicking Yes</li> </ol> <p>Your PT Survey is now shipped. Participants can begin submitting results.</p> <p>What just happened? The shipment is now visible in the Participant Portal. In a real scenario, this is when physical DTS samples would be distributed to testing sites alongside the ePT notification.</p>"},{"location":"training/exercises/dts-hiv-serology/#participant-section","title":"Participant Section","text":""},{"location":"training/exercises/dts-hiv-serology/#step-7-submit-results-as-participants","title":"Step 7: Submit Results as Participants","text":"<p>Repeat this for at least 3 of the 8 participants you created. To make evaluation meaningful, have some participants submit correct results and others submit intentionally incorrect results.</p> <p>For each participant:</p> <ol> <li>Go to the Participant Login page</li> <li>Log in using the participant's credentials (from Step 1)</li> <li>Click PT Result Submission on the left menu</li> <li>Find the shipment you created in Step 4</li> <li>Click Enter Result</li> <li>Fill in the result form for each sample:</li> <li>Test Kit \u2014 select any test kit from the dropdown for Test-1 (and Test-2, Test-3 if applicable)</li> <li>Individual test results \u2014 select Reactive or Non-Reactive for each test</li> <li>Final Interpretation \u2014 select HIV Positive or HIV Negative</li> <li>Documentation fields \u2014 fill in lot number, expiry date, etc. (these affect the documentation score)</li> <li>Click Submit</li> <li>Log out and repeat for the next participant</li> </ol> <p>Suggested result pattern for the exercise:</p> Participant Submit correct results? Purpose Participant 1 Yes \u2014 match the expected results Should pass evaluation Participant 2 Yes \u2014 match the expected results Should pass evaluation Participant 3 No \u2014 submit some incorrect final interpretations Should fail, to demonstrate evaluation scoring <p>Tip: Fill in the documentation fields (lot numbers, expiry dates) for at least one participant and leave them blank for another. This demonstrates how ePT scores documentation separately from test accuracy.</p> <p>Video guide: https://youtu.be/RE_rS5GlcJs</p>"},{"location":"training/exercises/dts-hiv-serology/#admin-section-continued","title":"Admin Section (continued)","text":""},{"location":"training/exercises/dts-hiv-serology/#step-8-evaluate-generate-reports-and-finalize","title":"Step 8: Evaluate, Generate Reports, and Finalize","text":"<p>8a. Evaluate:</p> <ol> <li>Return to the Admin section</li> <li>Go to Analyze \u2192 Evaluate Responses</li> <li>Find your shipment (use the search box) and click View</li> <li>Scroll to the bottom and click the green Evaluate button</li> <li>Review the results table \u2014 you should see:</li> <li>Participants who submitted correct results marked as Passed</li> <li>Participants who submitted incorrect results marked as Failed</li> <li>A Response Score (test accuracy) and Documentation Score for each participant</li> </ol> <p>Note: Evaluation can be run multiple times and is invisible to participants. Use this to verify results are scored correctly before generating reports.</p> <p>8b. Generate Reports:</p> <ol> <li>Go to Analyze \u2192 Generate Reports</li> <li>Find your shipment and click View</li> <li>Scroll down and click the green Report button</li> <li>Click Generate Participant Reports</li> <li>Wait a moment and refresh the page \u2014 reports generate in the background</li> </ol> <p>8c. Finalize:</p> <ol> <li>Go to Analyze \u2192 Finalize Reports</li> <li>Find your shipment and click View</li> <li>Scroll down and click the green Finalize button</li> <li>Click Generate Reports and Finalize Shipment</li> <li>Wait a moment and refresh the page</li> </ol> <p>Important: Finalization is permanent. Once finalized, participants can download their individual reports. In a real scenario, ensure evaluation and reports are correct before this step.</p>"},{"location":"training/exercises/dts-hiv-serology/#step-9-review-performance-reports","title":"Step 9: Review Performance Reports","text":"<ol> <li>Go to Reports \u2192 Shipment Reports</li> <li>Find your shipment and click the green shipment code link</li> <li>An Excel file will download \u2014 open it and explore the sheets:</li> <li>Summary \u2014 overall shipment statistics</li> <li>Participant results \u2014 per-participant scores and pass/fail status</li> <li>Sample-level detail \u2014 how each participant responded to each sample</li> </ol>"},{"location":"training/exercises/dts-hiv-serology/#participant-section-continued","title":"Participant Section (continued)","text":""},{"location":"training/exercises/dts-hiv-serology/#step-10-download-reports-as-a-participant","title":"Step 10: Download Reports as a Participant","text":"<ol> <li>Go to the Participant Login page and log in as one of the participants who submitted results</li> <li>Click View PT Results \u2192 Individual Reports on the left menu</li> <li>Search for your shipment and download the report</li> <li>Open the PDF \u2014 it includes the participant's results, scores, and any corrective actions</li> </ol> <p>Video guide: https://youtu.be/oUsc9-CgvxI</p>"},{"location":"training/exercises/dts-hiv-serology/#exercise-checklist","title":"Exercise Checklist","text":"<p>Use this to verify you've completed each step:</p> <ul> <li>[ ] 8 participants added via bulk import</li> <li>[ ] 8 participants enrolled in the HIV Serology scheme</li> <li>[ ] PT Survey created with a recognizable code</li> <li>[ ] DTS HIV Serology shipment added with 5 samples and expected results</li> <li>[ ] 8 participants enrolled in the shipment</li> <li>[ ] PT Survey shipped</li> <li>[ ] Results submitted for at least 3 participants (mix of correct and incorrect)</li> <li>[ ] Shipment evaluated \u2014 pass/fail results visible</li> <li>[ ] Participant reports generated</li> <li>[ ] Shipment finalized</li> <li>[ ] Performance report downloaded and reviewed (admin)</li> <li>[ ] Individual report downloaded as a participant</li> </ul>"},{"location":"training/exercises/dts-hiv-serology/#troubleshooting","title":"Troubleshooting","text":"Problem Solution Participants not showing in scheme enrollment Verify they were imported successfully in Configure \u2192 PT Participants and are in Active status Participants not showing in shipment enrollment They must be enrolled in the scheme first (Step 2) Participant can't see the shipment after login The PT Survey must be shipped first (Step 6). Also verify the participant is enrolled in the shipment (Step 5) Evaluation shows no results Make sure at least one participant has submitted results (Step 7) Reports not generating Wait a moment and refresh the page. Report generation runs in the background Participant can't download reports The shipment must be finalized first (Step 8c)"}]}