<link rel="stylesheet" type="text/css" href="<?php echo $this->baseUrl('css/bootstrap-select.min.css'); ?>" />
<link href="<?php echo $this->baseUrl('css/select2.css'); ?>" rel="stylesheet" />
<div class="well">
    <form enctype="multipart/form-data" name="addCertificateTemplateForm" id="addCertificateTemplateForm" method="post" action="<?php echo $this->url(array("module" => "admin", "controller" => "certificate-template", "action" => "add"), 'default', true) ?>" class="form-horizontal bs-example" role="form" onsubmit="validateNow();return false;">
        <fieldset>
            <legend>Add New Certificate Template</legend>

            <div class="form-group col-lg-6">
                <label class="col-lg-4 control-label" for="scheme">Scheme Type <span class="mandatory">*</span></label>
                <div class="col-lg-8">
                    <select id="scheme" name="scheme" class="isRequired form-control input-sm">
                        <option value=""> -- Select Scheme Type --</option>
                        <?php foreach ($this->schemes as $scheme) { ?>
                            <option value="<?php echo $scheme['scheme_id']; ?>"><?php echo $scheme['scheme_name']; ?></option>
                        <?php } ?>
                    </select>
                </div>
            </div>
            <div class="form-group col-lg-6">
                <label class="col-lg-4 control-label" for="templateType">Certificate Template Type <span class="mandatory">*</span></label>
                <div class="col-lg-8">
                    <select id="templateType" name="templateType" class="isRequired form-control input-sm" onchange="setTemplate(this.value);">
                        <option value=""> -- Select Template Type --</option>
                        <option value="participation">Participation</option>
                        <option value="excellence">Excellence</option>
                    </select>
                </div>
            </div>

            <div class="form-group col-lg-6">
                <label class="col-lg-4 control-label" for="pCertificate">Participation Certificate</label>
                <div class="col-lg-8">
                    <input type="file" id="pCertificate" name="pCertificate" class="form-control" title="Please upload the participation certificate" placeholder="Upload the participation certificate" />
                </div>
            </div>
            <div class="form-group col-lg-6">
                <label class="col-lg-4 control-label" for="eCertificate">Excellence Certificate</label>
                <div class="col-lg-8">
                    <input type="file" id="eCertificate" name="eCertificate" class="form-control" title="Please upload the excellence certificate" placeholder="Upload the excellence certificate" />
                </div>
            </div>

            <br>
            <div id="respond" style="margin: 0px auto 0px auto; text-align: center;" class="form-group col-lg-11" align="center">
                <input name="submitbtn" class="btn btn-primary" type="submit" tabindex="7" value="Add" />
                <input class="btn btn-danger" type="button" onclick="window.location.href = '/admin/certificate-template';" tabindex="8" value="Cancel" />
            </div>
        </fieldset>
    </form>
</div>
<script type="text/javascript" src="<?php echo $this->baseUrl('js/bootstrap-select.min.js'); ?>"></script>
<script type="text/javascript" src="<?php echo $this->baseUrl('js/select2.min.js'); ?>"></script>
<script type="text/javascript">
    var duplicated = false;

    $(document).ready(function() {

    });

    function setTemplate(val) {
        console.log("came");
        $("#pCertificate, #eCertificate").prop("disabled", true);
        if (val == "participation") {
            $("#pCertificate").prop("disabled", false);
        } else if (val == "excellence") {
            $("#eCertificate").prop("disabled", false);
        }
    }

    function checkDuplicate(tableName, fieldName, obj, fnct, msg) {
        $.post("<?php echo $this->url(array('module' => 'default', 'controller' => 'common', 'action' => 'check-duplicate')); ?>", {
                tableName: tableName,
                fieldName: fieldName,
                value: obj.value,
                fnct: fnct,
                format: "html"
            },
            function(data) {
                if (data > 0) {
                    alert(msg, "err");
                    duplicated = true;
                    obj.focus();
                } else {
                    duplicated = false;
                }
            });
    }

    function validateNow() {
        flag = deforayValidator.init({
            formId: 'addCertificateTemplateForm'
        });
        if (flag && !duplicated) {
            $.blockUI();
            document.getElementById('addCertificateTemplateForm').submit();
        }
    }
</script>