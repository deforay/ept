<div class="well">
	<form name="editTestTypeForm" id="editTestTypeForm" method="post" action="<?php echo $this->url(array("module" => "admin", "controller" => "test-platform", "action" => "edit"), 'default', true) ?>" class="form-horizontal bs-example" role="form" onsubmit="validateNow();return false;">
		<fieldset>
			<legend><?= $this->translate->_("Edit Test Platform"); ?></legend>

			<div class="form-group col-lg-6">
				<label class="col-lg-4 control-label" for="testPlatformName"><?= $this->translate->_("Test Platform Name"); ?> <span class="mandatory">*</span></label>
				<div class="col-lg-8">
					<input type="text" id="testPlatformName" name="testPlatformName" size="50" maxlength="255" class="isRequired form-control" title="Please enter the Test Platform Name here" placeholder="Please enter the Test Platform Name here" onblur="checkDuplicate('r_test_type_covid19', 'test_type_id', this, '<?php echo "test_type_id##" . $this->result['test_type_id']; ?>', 'This Test Platform Name already exists for another Test Platform. Please try something else.')" value="<?php echo $this->result['test_type_name']; ?>" />
				</div>
			</div>

			<div class="form-group col-lg-6">
				<label class="col-lg-4 control-label" for="shortTestTypeName"><?= $this->translate->_("Short Test Platform Name"); ?></label>
				<div class="col-lg-8">
					<input type="text" id="shortTestTypeName" name="shortTestTypeName" size="50" maxlength="255" class="form-control" title="Please enter the Short Test Platform Name here" placeholder="Please enter the Short Test Platform Name here" value="<?php echo $this->result['test_type_short_name']; ?>" />
					<input type="hidden" id="testtypeId" name="testtypeId" size="50" maxlength="255" class="form-control" value="<?php echo $this->result['test_type_id']; ?>" />
				</div>
			</div>

			<div class="form-group col-lg-6">
				<label class="col-lg-4 control-label" for="approvalAgency"><?= $this->translate->_("Approval Agency"); ?> <span class="mandatory">*</span></label>
				<div class="col-lg-8">
					<input type="text" id="approvalAgency" name="approvalAgency" size="50" maxlength="255" class="isRequired form-control" title="Please enter the approval Agency here" placeholder="Please enter the approval Agency here" value="<?php echo $this->result['test_type_approval_agency']; ?>" />
				</div>
			</div>
			<div class="form-group col-lg-6">
				<label class="col-lg-4 control-label" for="scheme"><?= $this->translate->_("Scheme"); ?> <span class="mandatory">*</span></label>

				<div class="col-lg-8">
					<select id="scheme" name="scheme" class="form-control isRequired" title="Please select the Scheme">
						<option value="">--<?= $this->translate->_("Select Scheme"); ?>--</option>
						<?php foreach ($this->schemeList as $scheme) { ?>
							<option value="<?php echo $scheme->scheme_id; ?>" <?php echo (isset($this->result['scheme_type']) && $this->result['scheme_type'] == $scheme->scheme_id) ? " selected='selected'" : ""; ?>><?php echo $scheme->scheme_name; ?></option>
						<?php } ?>
					</select>
				</div>
			</div>
			<div class="form-group col-lg-6">
				<label class="col-lg-4 control-label" for="sourceReference"><?= $this->translate->_("Source Reference"); ?></label>

				<div class="col-lg-8">
					<input type="text" id="sourceReference" name="sourceReference" size="50" maxlength="255" class="form-control" title="Please enter the Source Reference here" placeholder="Please enter the Source Reference here" value="<?php echo $this->result['source_reference']; ?>" />
				</div>
			</div>

			<div class="form-group col-lg-6">
				<label class="col-lg-4 control-label" for="manufacturer"><?= $this->translate->_("Test Platform Manufacturer"); ?></label>
				<div class="col-lg-8">
					<input type="text" id="manufacturer" name="manufacturer" size="50" maxlength="255" class="form-control" title="Please enter the test-platform manufacturer here" placeholder="Please enter the test-platform manufacturer here" value="<?php echo $this->result['test_type_manufacturer']; ?>" />
				</div>
			</div>

			<div class="form-group col-lg-6">
				<label class="col-lg-4 control-label" for="comments"><?= $this->translate->_("Comments"); ?></label>
				<div class="col-lg-8">
					<textarea class="form-control" name="comments" id="comments"><?php echo $this->result['test_type_comments']; ?></textarea>
				</div>
			</div>

			<div class="form-group col-lg-6">
				<label class="col-lg-4 control-label" for="approved"><?= $this->translate->_("Approved"); ?> <span class="mandatory">*</span></label>
				<div class="col-lg-8">
					<select class="form-control isRequired" name="approved" id="approved" title="Please choose the test-platform approved here">
						<option value="">-- <?= $this->translate->_("Select"); ?> --</option>
						<option value="1" <?php echo (($this->result["approval"] == '1') ? "selected='selected'" : "") ?>><?= $this->translate->_("Yes"); ?></option>
						<option value="0" <?php echo (($this->result["approval"] == '0') ? "selected='selected'" : "") ?>><?= $this->translate->_("No"); ?></option>
					</select>
				</div>
			</div>

			<div class="form-group col-lg-6">
				<label class="col-lg-4 control-label" for="countryAdapted"><?= $this->translate->_("Country Adapted"); ?> <span class="mandatory">*</span></label>
				<div class="col-lg-8">
					<select class="form-control isRequired" name="countryAdapted" id="countryAdapted" title="Please choose the country adapted here">
						<option value="">-- <?= $this->translate->_("Select"); ?> --</option>
						<option value="1" <?php echo (($this->result["country_adapted"] == '1') ? "selected='selected'" : "") ?>><?= $this->translate->_("Yes"); ?></option>
						<option value="0" <?php echo (($this->result["country_adapted"] == '0') ? "selected='selected'" : "") ?>><?= $this->translate->_("No"); ?></option>
					</select>
				</div>
			</div>

			<div id="respond" style="margin: 0px auto 0px auto; text-align: center;" class="form-group col-lg-11" align="center">
				<input name="submitbtn" class="btn btn-primary" type="submit" tabindex="7" value="Update" />
				<input class="btn btn-danger" type="button" onclick="window.location.href = '/admin/test-platform';" tabindex="8" value="Cancel" />
			</div>
		</fieldset>
	</form>
</div>

<script type="text/javascript">
	var duplicated = false;

	function checkDuplicate(tableName, fieldName, obj, fnct, msg) {
		$.post("<?php echo $this->url(array('module' => 'default', 'controller' => 'common', 'action' => 'check-duplicate')); ?>", {
				tableName: tableName,
				fieldName: fieldName,
				value: obj.value,
				fnct: fnct,
				format: "html"
			},
			function(data) {
				if (data > 0) {
					alert(msg, "err");
					duplicated = true;
					obj.focus();
				} else {
					duplicated = false;
				}
			});
	}

	function validateNow() {
		flag = deforayValidator.init({
			formId: 'editTestTypeForm'
		});
		if (flag && !duplicated) {
			$.blockUI();
			document.getElementById('editTestTypeForm').submit();
		}
	}
</script>
