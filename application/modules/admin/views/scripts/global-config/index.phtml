<?php
$emailConfig = json_decode($this->mail);
$recency = json_decode($this->recency);
$home = json_decode($this->home);
$faqResults = json_decode($this->faqs);
?>
<style>
	/* Style the button that is used to open and close the collapsible content */
	.collapsible {
		background: linear-gradient(135deg, #4a6fa5 0%, #3a5a8a 100%);
		color: #fff;
		cursor: pointer;
		padding: 14px 18px;
		width: 100%;
		border: none;
		text-align: left;
		outline: none;
		font-size: 15px;
		font-weight: 500;
		border-radius: 4px 4px 0 0;
		margin-top: 10px;
		transition: all 0.2s ease;
	}

	/* Add a background color to the button if it is clicked on (add the .active class with JS), and when you move the mouse over it (hover) */
	.collapsible.active {
		background: linear-gradient(135deg, #4a6fa5 0%, #3a5a8a 100%);
		border-radius: 4px 4px 0 0;
	}

	.collapsible:hover {
		background: linear-gradient(135deg, #5a7fb5 0%, #4a6a9a 100%);
	}

	.collapsible .caret {
		border-top-color: #fff;
	}

	/* Style the collapsible content. Note: shown by default */
	.collapse-content {
		padding: 20px;
		display: block;
		overflow: hidden;
		background-color: #f8fafc;
		border: 1px solid #e2e8f0;
		border-top: none;
		border-radius: 0 0 4px 4px;
		margin-bottom: 5px;
	}

	/* Row spacing within sections */
	.collapse-content .row {
		margin-bottom: 15px;
		padding-bottom: 15px;
		border-bottom: 1px solid #eef2f7;
	}

	.collapse-content .row:last-child {
		border-bottom: none;
		margin-bottom: 0;
		padding-bottom: 0;
	}

	/* Label styling */
	.collapse-content .control-label {
		color: #374151;
		font-weight: 500;
		margin-bottom: 6px;
		display: block;
	}

	/* Form control focus state */
	.collapse-content .form-control:focus {
		border-color: #4a6fa5;
		box-shadow: 0 0 0 3px rgba(74, 111, 165, 0.1);
	}

	.radioBtn .notActive {
		color: #4a6fa5;
		background-color: #fff;
		border-color: #4a6fa5;
	}

	.radioBtn .active {
		background-color: #4a6fa5;
		border-color: #3a5a8a;
	}

	.search-jump-container {
		background: linear-gradient(135deg, #f0f7ff 0%, #e8f4fd 100%);
		padding: 20px;
		margin-bottom: 20px;
		border-radius: 8px;
		border: 1px solid #c5ddf8;
	}

	.search-jump-container .control-label {
		color: #374151;
		font-weight: 500;
	}

	.control-buttons {
		text-align: right;
		margin-bottom: 15px;
	}

	/* Floating action buttons */
	.floating-buttons {
		position: fixed;
		bottom: 20px;
		right: 30px;
		z-index: 1000;
		display: flex;
		gap: 10px;
		background: #fff;
		padding: 15px 20px;
		border-radius: 8px;
		box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
		border: 1px solid #e2e8f0;
	}

	.floating-buttons .btn {
		padding: 10px 25px;
		font-size: 14px;
	}

	/* Add some bottom padding to form to prevent floating buttons from covering content */
	#respond {
		margin-bottom: 80px !important;
	}

	/* Sub-section headings */
	.collapse-content h5 {
		color: #4a6fa5;
		font-weight: 600;
		margin-top: 20px;
		border-bottom: 2px solid #4a6fa5 !important;
		padding-bottom: 8px !important;
	}

	.collapse-content h5 i {
		margin-right: 8px;
	}

	/* Alert info boxes */
	.collapse-content .alert-info {
		background-color: #e8f4fd;
		border-color: #bee3f8;
		color: #2c5282;
	}

	/* Style TomSelect wrapper to match form controls */
	.ts-wrapper {
		width: 100%;
	}

	.ts-wrapper .ts-control {
		border: 1px solid #cbd5e0;
		border-radius: 4px;
		padding: 6px 12px;
		min-height: 38px;
		background-color: #fff;
	}

	.ts-wrapper .ts-control:focus,
	.ts-wrapper.focus .ts-control {
		border-color: #4a6fa5;
		box-shadow: 0 0 0 3px rgba(74, 111, 165, 0.1);
	}

	/* TomSelect selected items (tags) */
	.ts-wrapper.multi .ts-control > div {
		background: linear-gradient(135deg, #4a6fa5 0%, #3a5a8a 100%);
		color: #fff;
		border: none;
		border-radius: 4px;
		padding: 4px 10px;
		margin: 2px 4px 2px 0;
		font-size: 13px;
	}

	.ts-wrapper.multi .ts-control > div .remove {
		color: rgba(255, 255, 255, 0.7);
		border-left: 1px solid rgba(255, 255, 255, 0.3);
		margin-left: 6px;
		padding-left: 6px;
	}

	.ts-wrapper.multi .ts-control > div .remove:hover {
		color: #fff;
		background: transparent;
	}

	/* TomSelect dropdown */
	.ts-dropdown {
		border: 1px solid #cbd5e0;
		border-radius: 4px;
		box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
		margin-top: 2px;
	}

	.ts-dropdown .option {
		padding: 10px 12px;
		color: #374151;
	}

	.ts-dropdown .option:hover,
	.ts-dropdown .option.active {
		background-color: #e8f4fd;
		color: #2c5282;
	}

	.ts-dropdown .option.selected {
		background-color: #4a6fa5;
		color: #fff;
	}

	/* Ensure TomSelect properly hides the original select - using multiple selectors for specificity */
	.ts-wrapper ~ select#schemeId,
	select#schemeId.tomselected,
	select.ts-hidden-accessible {
		position: absolute !important;
		left: -9999px !important;
		visibility: hidden !important;
	}

	/* Table styling for FAQ */
	.collapse-content .table {
		background-color: #fff;
		border-radius: 4px;
		overflow: hidden;
	}

	.collapse-content .table thead th {
		background: linear-gradient(135deg, #4a6fa5 0%, #3a5a8a 100%);
		color: #fff;
		font-weight: 500;
		border: none;
		padding: 12px;
	}

	.collapse-content .table tbody tr:hover {
		background-color: #f0f7ff;
	}

	/* Small/muted text */
	.collapse-content .text-muted {
		color: #6b7280;
	}

	/* Legend styling */
	legend {
		color: #1f2937;
		font-weight: 600;
		border-bottom: 2px solid #4a6fa5;
		padding-bottom: 10px;
	}

	/* Feature card rows */
	.feature-card-row {
		background: #fff;
		border: 1px solid #e2e8f0;
		border-radius: 6px;
		padding: 15px;
		margin-bottom: 15px !important;
		border-bottom: none !important;
	}

	.feature-card-row:hover {
		border-color: #4a6fa5;
		box-shadow: 0 2px 8px rgba(74, 111, 165, 0.1);
	}
</style>

<div class="well">
	<form name="globalConfigForm" id="globalConfigForm" method="post"
		action="<?php echo $this->url(array("module" => "admin", "controller" => "global-config", "action" => "index"), 'default', true) ?>"
		class="form-horizontal" enctype="multipart/form-data" autocomplete="off" role="form">
		<fieldset>
			<legend><?= $this->translate->_("ePT Global Settings"); ?></legend>

			<!-- Search and Jump Section -->
			<div class="search-jump-container">
				<div class="row">
					<div class="col-md-6">
						<label for="searchSettings"
							class="control-label"><?= $this->translate->_("Search settings by keyword"); ?></label>
						<div class="input-group">
							<span class="input-group-addon"><i class="icon-search"></i></span>
							<input type="text" class="form-control" id="searchSettings"
								placeholder="<?= $this->translate->_('Search settings by keyword'); ?>" />
						</div>
					</div>
					<div class="col-md-6">
						<label for="jumpToSection"
							class="control-label"><?= $this->translate->_("Jump to Section"); ?></label>
						<select class="form-control" id="jumpToSection">
							<option value="">-- <?= $this->translate->_("Select Section"); ?> --</option>
							<option value="generalConfig"><?= $this->translate->_("General Settings"); ?></option>
							<option value="participantConfig"><?= $this->translate->_("Participant Settings"); ?></option>
							<option value="emailConfig"><?= $this->translate->_("Email Settings"); ?></option>
							<option value="homeConfig"><?= $this->translate->_("Home Page Settings"); ?></option>
						</select>
					</div>
				</div>
			</div>

			<!-- Control Buttons -->
			<div class="control-buttons">
				<button type="button" class="btn btn-sm btn-info" id="expandAll">
					<i class="icon-resize-full"></i> <?= $this->translate->_("Expand All"); ?>
				</button>
				<button type="button" class="btn btn-sm btn-warning" id="collapseAll">
					<i class="icon-resize-small"></i> <?= $this->translate->_("Collapse All"); ?>
				</button>
			</div>

			<button type="button" class="collapsible active" data-toggle="collapse" data-target="#generalConfig"
				aria-expanded="true" aria-controls="collapseExample"><?= $this->translate->_("General Settings"); ?> <b class="caret pull-right"
					style="text-align:right;"></b></button>
			<div class="collapse-content" id="generalConfig">
				<div class="row">
					<div class="col-md-6">
						<label for="host" class="control-label"><?= $this->translate->_("Domain"); ?></label>
						<input type="text" value="<?php echo $this->domain ?? null; ?>" id="domain"
							name="emailConfig[domain]" class="form-control" style="background: #fff"
							title="<?= $this->translate->_('Domain for this ePT instance'); ?>" />
						<small class="text-muted"><?= $this->translate->_("Auto-filled from URL. Edit if using a proxy or CDN."); ?></small>
					</div>
					<div class="col-md-6">
						<label for="locale" class="control-label"><?= $this->translate->_("Language"); ?></label>
						<select class="form-control" id="locale" name="locale"
							title="<?= $this->translate->_('Select the language for this instance'); ?>">
							<option value="">-- <?= $this->translate->_("Select"); ?> --</option>
							<option value="en_US" <?php echo ($this->locale == "en_US") ? "selected='selected'" : ""; ?>>
								<?= $this->translate->_("English"); ?></option>
							<option value="fr_FR" <?php echo ($this->locale == "fr_FR") ? "selected='selected'" : ""; ?>>
								<?= $this->translate->_("French"); ?></option>
						</select>
					</div>
				</div>
				<!-- Rest of general config fields... -->
				<div class="row">
					<div class="col-md-6">
						<label for="aggregate_insights_url"
							class="control-label"><?= $this->translate->_("Aggregate Insights URL"); ?></label>
						<input type="text" class="form-control" id="aggregate_insights_url"
							name="aggregate_insights_url" placeholder="<?= $this->translate->_('Enter aggregate insights URL'); ?>"
							title="<?= $this->translate->_('Enter the URL for aggregate insights dashboard'); ?>"
							value="<?php echo $this->aggregate_insights_url; ?>" />
					</div>
					<div class="col-md-6">
						<label for="admin_email"
							class="control-label"><?= $this->translate->_("Administrator Email"); ?></label>
						<input type="text" class="form-control" id="admin_email" name="admin_email"
							placeholder="<?= $this->translate->_('Enter administrator email (optional)'); ?>" title="<?= $this->translate->_('Enter the administrator email address'); ?>"
							value="<?= $this->admin_email; ?>" />
					</div>
				</div>
				<div class="row">
					<div class="col-md-6">
						<label for="pt_program_name"
							class="control-label"><?= $this->translate->_("PT Program Name"); ?></label>
						<input type="text" class="form-control" id="pt_program_name" name="pt_program_name"
							placeholder="<?= $this->translate->_('Enter PT program name'); ?>" title="<?= $this->translate->_('Enter the full name of your PT program'); ?>"
							value="<?php echo $this->pt_program_name; ?>" />
					</div>
					<div class="col-md-6">
						<label for="pt_program_short_name"
							class="control-label"><?= $this->translate->_("PT Program Short Name"); ?></label>
						<input type="text" class="form-control" id="pt_program_short_name" name="pt_program_short_name"
							placeholder="<?= $this->translate->_('Enter PT program short name'); ?>" title="<?= $this->translate->_('Enter an abbreviated name for your PT program'); ?>"
							value="<?php echo $this->pt_program_short_name; ?>" />
					</div>
				</div>
				<div class="row">
					<div class="col-md-6">
						<label for="training_instance"
							class="control-label"><?= $this->translate->_("Training Instance"); ?></label>
						<select class="form-control" id="training_instance" name="training_instance"
							title="<?= $this->translate->_('Is this ePT installation used for training purposes?'); ?>">
							<option value="no" <?php echo ($this->training_instance == "no") ? "selected='selected'" : ""; ?>><?= $this->translate->_("No"); ?></option>
							<option value="yes" <?php echo ($this->training_instance == "yes") ? "selected='selected'" : ""; ?>><?= $this->translate->_("Yes"); ?></option>
						</select>
					</div>
					<div class="col-md-6">
						<label for="schemeId" class="control-label"><?= $this->translate->_("Active Schemes"); ?> <span class="mandatory">*</span></label>
						<select id="schemeId" name="schemeId[]" multiple>
							<?php foreach ($this->allSchemes as $schemes) { ?>
								<option value="<?php echo $schemes["scheme_id"] ?>" <?php echo ($schemes['status'] == "active") ? "selected" : ""; ?>>
									<?php echo ucwords($schemes["scheme_name"]); ?></option>
							<?php } ?>
						</select>
						<small class="text-muted"><?= $this->translate->_("Select at least one scheme to enable"); ?></small>
					</div>
				</div>
				<div class="row">
					<div class="col-md-6 trainingText">
						<label for="training_instance_text"
							class="control-label"><?= $this->translate->_("Report Watermark"); ?></label>
						<input type="text" class="form-control" id="training_instance_text"
							name="training_instance_text" placeholder="<?= $this->translate->_('Watermark text for training reports'); ?>"
							title="<?= $this->translate->_('Enter the watermark text to display on training reports'); ?>"
							value="<?php echo $this->training_instance_text; ?>" />
					</div>
					<div class="col-md-6">
						<label for="response_after_evaluate"
							class="control-label"><?= $this->translate->_("Accept Responses After Finalization"); ?></label>
						<div class="input-group">
							<div class="btn-group radioBtn">
								<a class="btn btn-primary btn-sm <?php echo (isset($this->response_after_evaluate) && $this->response_after_evaluate == "yes") ? " active " : "notActive"; ?>"
									data-toggle="response_after_evaluate" data-title="yes"
									onclick="toggleRadios(this);"><?= $this->translate->_("YES"); ?></a>
								<a class="btn btn-primary btn-sm <?php echo (!isset($this->response_after_evaluate) || $this->response_after_evaluate == "no") ? " active " : "notActive"; ?>"
									data-toggle="response_after_evaluate" data-title="no"
									onclick="toggleRadios(this);"><?= $this->translate->_("NO"); ?></a>
							</div>
							<input type="hidden" name="response_after_evaluate" id="response_after_evaluate" value="<?php echo $this->response_after_evaluate ?? "no"; ?>">
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-md-6">
						<label for="generic_test_config"
							class="control-label"><?= $this->translate->_("Enable Custom Tests"); ?></label>
						<div class="input-group">
							<div class="btn-group radioBtn">
								<a class="btn btn-primary btn-sm <?php echo (isset($this->generic_test_config) && $this->generic_test_config == "yes") ? " active " : "notActive"; ?>"
									data-toggle="generic_test_config" data-title="yes"
									onclick="toggleRadios(this);"><?= $this->translate->_("YES"); ?></a>
								<a class="btn btn-primary btn-sm <?php echo (!isset($this->generic_test_config) || $this->generic_test_config == "no") ? " active " : "notActive"; ?>"
									data-toggle="generic_test_config" data-title="no"
									onclick="toggleRadios(this);"><?= $this->translate->_("NO"); ?></a>
							</div>
							<input type="hidden" name="generic_test_config" id="generic_test_config" value="<?php echo $this->generic_test_config ?? "no"; ?>">
						</div>
					</div>
					<div class="col-md-6">
						<label for="evaluate_before_generating_reports"
							class="control-label"><?= $this->translate->_("Re-evaluate Before Finalizing"); ?></label>
						<div class="input-group">
							<div class="btn-group radioBtn">
								<a class="btn btn-primary btn-sm <?php echo (isset($this->evaluate_before_generating_reports) && $this->evaluate_before_generating_reports == "yes") ? " active " : "notActive"; ?>"
									data-toggle="evaluate_before_generating_reports" data-title="yes"
									onclick="toggleRadios(this);"><?= $this->translate->_("YES"); ?></a>
								<a class="btn btn-primary btn-sm <?php echo (!isset($this->evaluate_before_generating_reports) || $this->evaluate_before_generating_reports == "no") ? " active " : "notActive"; ?>"
									data-toggle="evaluate_before_generating_reports" data-title="no"
									onclick="toggleRadios(this);"><?= $this->translate->_("NO"); ?></a>
							</div>
							<input type="hidden" name="evaluate_before_generating_reports"
								id="evaluate_before_generating_reports" value="<?php echo $this->evaluate_before_generating_reports ?? "no"; ?>">
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-md-6">
						<label for="enable_capa" class="control-label"><?= $this->translate->_("Enable CAPA"); ?></label>
						<div class="input-group">
							<div class="btn-group radioBtn">
								<a class="btn btn-primary btn-sm <?php echo (isset($this->enable_capa) && $this->enable_capa == "yes") ? " active " : "notActive"; ?>"
									data-toggle="enable_capa" data-title="yes" onclick="toggleRadios(this);"><?= $this->translate->_("YES"); ?></a>
								<a class="btn btn-primary btn-sm <?php echo (!isset($this->enable_capa) || $this->enable_capa == "no") ? " active " : "notActive"; ?>"
									data-toggle="enable_capa" data-title="no" onclick="toggleRadios(this);"><?= $this->translate->_("NO"); ?></a>
							</div>
							<input type="hidden" name="enable_capa" id="enable_capa" value="<?php echo $this->enable_capa ?? "no"; ?>">
						</div>
					</div>
					<div class="col-md-6">
						<label for="enable_admin_email_notification"
							class="control-label"><?= $this->translate->_("Admin Email Notifications"); ?></label>
						<div class="input-group">
							<div class="btn-group radioBtn">
								<a class="btn btn-primary btn-sm <?php echo (isset($this->enable_admin_email_notification) && $this->enable_admin_email_notification == "yes") ? " active " : "notActive"; ?>"
									data-toggle="enable_admin_email_notification" data-title="yes"
									onclick="toggleRadios(this);"><?= $this->translate->_("YES"); ?></a>
								<a class="btn btn-primary btn-sm <?php echo (!isset($this->enable_admin_email_notification) || $this->enable_admin_email_notification == "no") ? " active " : "notActive"; ?>"
									data-toggle="enable_admin_email_notification" data-title="no"
									onclick="toggleRadios(this);"><?= $this->translate->_("NO"); ?></a>
							</div>
							<input type="hidden" name="enable_admin_email_notification" id="enable_admin_email_notification" value="<?php echo $this->enable_admin_email_notification ?? "no"; ?>">
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-md-6">
						<label for="institute_name"
							class="control-label"><?= $this->translate->_("Institute Name"); ?></label>
						<textarea class="form-control" id="institute_name" name="institute_name"
							placeholder="<?= $this->translate->_('Enter institute name'); ?>"
							title="<?= $this->translate->_('Enter the name of your institute'); ?>"><?php echo $this->institute_name; ?></textarea>
					</div>
					<div class="col-md-6">
						<label for="institute_address"
							class="control-label"><?= $this->translate->_("Institute Address"); ?></label>
						<textarea class="form-control" id="institute_address" name="institute_address"
							placeholder="<?= $this->translate->_('Enter institute address'); ?>"
							title="<?= $this->translate->_('Enter your institute address'); ?>"><?php echo $this->institute_address; ?></textarea>
					</div>
				</div>
				<div class="row">
					<div class="col-md-6">
						<label for="additional_institute_details"
							class="control-label"><?= $this->translate->_("Additional Institute Details"); ?></label>
						<textarea class="form-control" id="additional_institute_details"
							name="additional_institute_details" placeholder="<?= $this->translate->_('Enter additional institute details'); ?>"
							title="<?= $this->translate->_('Enter any additional details about your institute'); ?>"><?php echo $this->additional_institute_details; ?></textarea>
					</div>
					<div class="col-md-6">
						<label for="theme_color"
							class="control-label"><?= $this->translate->_("Theme Color"); ?></label>
						<select class="form-control" id="theme_color" name="theme_color"
							title="<?= $this->translate->_('Select a theme color for the interface'); ?>">
							<option value="">-- <?= $this->translate->_("Select"); ?> --</option>
							<option value="green" <?php echo (isset($this->theme_color) && $this->theme_color == 'green') ? 'selected="selected"' : ""; ?>><?= $this->translate->_("Green"); ?></option>
							<option value="blue" <?php echo (isset($this->theme_color) && $this->theme_color == 'blue') ? 'selected="selected"' : ""; ?>><?= $this->translate->_("Blue"); ?></option>
							<option value="yellow" <?php echo (isset($this->theme_color) && $this->theme_color == 'yellow') ? 'selected="selected"' : ""; ?>><?= $this->translate->_("Yellow"); ?></option>
							<option value="purple" <?php echo (isset($this->theme_color) && $this->theme_color == 'purple') ? 'selected="selected"' : ""; ?>><?= $this->translate->_("Purple"); ?></option>
							<option value="red" <?php echo (isset($this->theme_color) && $this->theme_color == 'red') ? 'selected="selected"' : ""; ?>><?= $this->translate->_("Red"); ?></option>
							<option value="black" <?php echo (isset($this->theme_color) && $this->theme_color == 'black') ? 'selected="selected"' : ""; ?>><?= $this->translate->_("Black"); ?></option>
						</select>
					</div>
				</div>
				<div class="row">
					<div class="col-md-6">
						<label for="instance" class="control-label"><?= $this->translate->_("Instance"); ?></label>
						<select class="form-control" id="instance" name="instance" title="<?= $this->translate->_('Select the deployment instance'); ?>">
							<option value="">-- <?= $this->translate->_("Select"); ?> --</option>
							<option value="drc" <?php echo (isset($this->instance) && $this->instance == 'drc') ? 'selected="selected"' : ""; ?>>DRC</option>
							<option value="philippines" <?php echo (isset($this->instance) && $this->instance == 'philippines') ? 'selected="selected"' : ""; ?>>Philippines</option>
							<option value="myanmar" <?php echo (isset($this->instance) && $this->instance == 'myanmar') ? 'selected="selected"' : ""; ?>>Myanmar</option>
							<option value="zimbabwe" <?php echo (isset($this->instance) && $this->instance == 'zimbabwe') ? 'selected="selected"' : ""; ?>>Zimbabwe</option>
							<option value="malawi" <?php echo (isset($this->instance) && $this->instance == 'malawi') ? 'selected="selected"' : ""; ?>>Malawi</option>
							<option value="ghana" <?php echo (isset($this->instance) && $this->instance == 'ghana') ? 'selected="selected"' : ""; ?>>Ghana</option>
							<option value="mtbept" <?php echo (isset($this->instance) && $this->instance == 'mtbept') ? 'selected="selected"' : ""; ?>>MTBEPT</option>
							<option value="cdc-ilb-hiv" <?php echo (isset($this->instance) && $this->instance == 'cdc-ilb-hiv') ? 'selected="selected"' : ""; ?>>CDC-ILB-HIV</option>
						</select>
					</div>
					<div class="col-md-6">
						<label for="jobCompletionAlertStatus"
							class="control-label"><?= $this->translate->_("Job Completion Alerts"); ?></label>
						<select class="form-control" id="jobCompletionAlertStatus" name="job_completion_alert_status"
							title="<?= $this->translate->_('Enable email alerts when jobs complete'); ?>" onchange="showMailBox(this.value);">
							<option value="">-- <?= $this->translate->_("Select"); ?> --</option>
							<option value="yes" <?php echo ($this->job_completion_alert_status == "yes") ? "selected='selected'" : ""; ?>><?= $this->translate->_("Yes"); ?></option>
							<option value="no" <?php echo ($this->job_completion_alert_status == "no") ? "selected='selected'" : ""; ?>><?= $this->translate->_("No"); ?></option>
						</select>
					</div>
				</div>
				<div class="row">
					<div class="col-md-6">
						<label for="auto_generate_pt_survey_code"
							class="control-label"><?= $this->translate->_("Auto-generate PT Survey Code"); ?></label>
						<select class="form-control" id="auto_generate_pt_survey_code"
							name="auto_generate_pt_survey_code" title="<?= $this->translate->_('Automatically generate PT survey codes'); ?>">
							<option value="">-- <?= $this->translate->_("Select"); ?> --</option>
							<option value="yes" <?php echo ($this->auto_generate_pt_survey_code == "yes") ? "selected='selected'" : ""; ?>><?= $this->translate->_("Yes"); ?></option>
							<option value="no" <?php echo ($this->auto_generate_pt_survey_code == "no") ? "selected='selected'" : ""; ?>><?= $this->translate->_("No"); ?></option>
						</select>
					</div>
					<div class="col-md-6">
						<label for="footer_text"
							class="control-label"><?= $this->translate->_("Footer Text"); ?></label>
						<input type="text" class="form-control" id="footer_text"
							value="<?php echo $this->footer_text ?? null; ?>" placeholder="<?= $this->translate->_('Enter footer text'); ?>"
							name="footer_text" title="<?= $this->translate->_('Enter the text to display in the page footer'); ?>" />
					</div>
				</div>
				<div class="row">
					<div class="col-md-6 mail-box"
						style="display: <?php echo (isset($this->job_completion_alert_status) && ($this->job_completion_alert_status == "yes")) ? 'block' : 'none'; ?>;">
						<label for="jobCompletionAlertMails"
							class="control-label"><?= $this->translate->_("Job Completion Alert Recipients"); ?></label>
						<textarea class="form-control" id="jobCompletionAlertMails" name="job_completion_alert_mails"
							placeholder="<?= $this->translate->_('Enter email addresses'); ?>"
							title="<?= $this->translate->_('Enter email addresses to receive job completion alerts'); ?>"><?php echo $this->job_completion_alert_mails; ?></textarea>
						<small class="text-muted" style="color: #e83838ad;"><?= $this->translate->_("Enter comma-separated email addresses for multiple recipients"); ?></small>
					</div>
					<div class="col-md-6">
						<label for="date_format"
							class="control-label"><?= $this->translate->_("Date Format"); ?></label>
						<input type="text" value="<?php echo $this->date_format; ?>" class="form-control"
							id="date_format" name="date_format" placeholder="<?= $this->translate->_('e.g., d-M-Y'); ?>"
							title="<?= $this->translate->_('Enter the date format (e.g., d-M-Y)'); ?>">
					</div>
					<div class="col-md-6">
						<label for="certificates"
							class="control-label"><?= $this->translate->_("Certificate Email"); ?></label>
						<input type="text" value="<?php echo $this->certificates ?? ''; ?>" class="form-control"
							id="certificates" name="certificates" placeholder="<?= $this->translate->_('Enter certificate notification email'); ?>"
							title="<?= $this->translate->_('Enter the email address for certificate notifications'); ?>">
					</div>
				</div>
			</div><br>

			<button type="button" class="collapsible active" data-toggle="collapse" data-target="#participantConfig"
				aria-expanded="true" aria-controls="collapseExample"><?= $this->translate->_("Participant Settings"); ?> <b class="caret pull-right"
					style="text-align:right;"></b></button>
			<div class="collapse-content" id="participantConfig">
				<div class="row">
					<div class="col-md-6">
						<label for="participant_login_prefix"
							class="control-label"><?= $this->translate->_("Login ID Prefix"); ?></label>
						<input type="text" class="form-control" id="participant_login_prefix"
							name="participant_login_prefix" placeholder="<?= $this->translate->_('e.g., PT'); ?>"
							title="<?= $this->translate->_('Enter the prefix for participant login IDs'); ?>"
							value="<?php echo $this->participant_login_prefix; ?>" />
					</div>
					<div class="col-md-6">
						<label for="participant_login_password_length"
							class="control-label"><?= $this->translate->_("Password Length"); ?></label>
						<input type="text" class="form-control" id="participant_login_password_length"
							name="participant_login_password_length"
							placeholder="<?= $this->translate->_('e.g., 8'); ?>"
							title="<?= $this->translate->_('Enter the minimum password length for participants'); ?>"
							value="<?php echo $this->participant_login_password_length; ?>" />
					</div>
				</div>
				<div class="row">
					<div class="col-md-6">
						<label for="participants_can_edit_name"
							class="control-label"><?= $this->translate->_("Allow Name Editing"); ?></label>
						<div class="input-group">
							<div class="btn-group radioBtn">
								<a class="btn btn-primary btn-sm <?php echo (isset($this->participants_can_edit_name) && $this->participants_can_edit_name == "yes") ? " active " : "notActive"; ?>"
									data-toggle="participants_can_edit_name" data-title="yes"
									onclick="toggleRadios(this);"><?= $this->translate->_("YES"); ?></a>
								<a class="btn btn-primary btn-sm <?php echo (!isset($this->participants_can_edit_name) || $this->participants_can_edit_name == "no") ? " active " : "notActive"; ?>"
									data-toggle="participants_can_edit_name" data-title="no"
									onclick="toggleRadios(this);"><?= $this->translate->_("NO"); ?></a>
							</div>
							<input type="hidden" name="participants_can_edit_name" id="participants_can_edit_name"
								value="<?php echo $this->participants_can_edit_name ?? "no"; ?>">
						</div>
					</div>
					<div class="col-md-6">
						<label for="participant_feedback"
							class="control-label"><?= $this->translate->_("Enable Feedback"); ?></label>
						<div class="input-group">
							<div class="btn-group radioBtn">
								<a class="btn btn-primary btn-sm <?php echo (isset($this->participant_feedback) && $this->participant_feedback == "yes") ? " active " : "notActive"; ?>"
									data-toggle="participant_feedback" data-title="yes"
									onclick="toggleRadios(this);"><?= $this->translate->_("YES"); ?></a>
								<a class="btn btn-primary btn-sm <?php echo (!isset($this->participant_feedback) || $this->participant_feedback == "no") ? " active " : "notActive"; ?>"
									data-toggle="participant_feedback" data-title="no"
									onclick="toggleRadios(this);"><?= $this->translate->_("NO"); ?></a>
							</div>
							<input type="hidden" name="participant_feedback" id="participant_feedback" value="<?php echo $this->participant_feedback ?? "no"; ?>">
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-md-6">
						<label for="direct_participant_login"
							class="control-label"><?= $this->translate->_("Direct Login"); ?></label>
						<div class="input-group">
							<div class="btn-group radioBtn">
								<a class="btn btn-primary btn-sm <?php echo (isset($this->direct_participant_login) && $this->direct_participant_login == "yes") ? " active " : "notActive"; ?>"
									data-toggle="direct_participant_login" data-title="yes"
									onclick="toggleRadios(this);"><?= $this->translate->_("YES"); ?></a>
								<a class="btn btn-primary btn-sm <?php echo (!isset($this->direct_participant_login) || $this->direct_participant_login == "no") ? " active " : "notActive"; ?>"
									data-toggle="direct_participant_login" data-title="no"
									onclick="toggleRadios(this);"><?= $this->translate->_("NO"); ?></a>
							</div>
							<input type="hidden" name="direct_participant_login" id="direct_participant_login" value="<?php echo $this->direct_participant_login ?? "no"; ?>">
						</div>
					</div>
					<div class="col-md-6">
						<label for="enable_login_attempt_ban"
							class="control-label"><?= $this->translate->_("Login Attempt Ban"); ?></label>
						<div class="input-group">
							<div class="btn-group radioBtn">
								<a class="btn btn-primary btn-sm <?php echo (isset($this->enable_login_attempt_ban) && $this->enable_login_attempt_ban == "yes") ? " active " : "notActive"; ?>"
									data-toggle="enable_login_attempt_ban" data-title="yes"
									onclick="toggleRadios(this);participantLoginBan();"><?= $this->translate->_("YES"); ?></a>
								<a class="btn btn-primary btn-sm <?php echo (!isset($this->enable_login_attempt_ban) || $this->enable_login_attempt_ban == "no") ? " active " : "notActive"; ?>"
									data-toggle="enable_login_attempt_ban" data-title="no"
									onclick="toggleRadios(this);participantLoginBan();"><?= $this->translate->_("NO"); ?></a>
							</div>
							<input type="hidden" name="enable_login_attempt_ban" id="enable_login_attempt_ban" value="<?php echo $this->enable_login_attempt_ban ?? "no"; ?>">
						</div>
					</div>
				</div>
				<div
					class="row banTimer <?php echo (isset($this->enable_login_attempt_ban) && $this->enable_login_attempt_ban == "yes") ? "  " : "hide"; ?>">
					<div
						class="col-md-6 banTimer <?php echo (isset($this->enable_login_attempt_ban) && $this->enable_login_attempt_ban == "yes") ? "  " : "hide"; ?>">
						<label for="temporary_login_ban_time"
							class="control-label"><?= $this->translate->_("Temporary Ban Duration (minutes)"); ?></label>
						<input type="number" class="form-control" id="temporary_login_ban_time"
							name="temporary_login_ban_time" placeholder="<?= $this->translate->_('e.g., 5'); ?>"
							title="<?= $this->translate->_('Enter the duration for temporary login bans in minutes'); ?>"
							value="<?php echo $this->temporary_login_ban_time ?? 5; ?>" />
					</div>
					<div
						class="col-md-6 banTimer <?php echo (isset($this->enable_login_attempt_ban) && $this->enable_login_attempt_ban == "yes") ? "  " : "hide"; ?>">
						<label for="max_attempts_for_temp_ban"
							class="control-label"><?= $this->translate->_("Attempts Before Temporary Ban"); ?></label>
						<input type="number" class="form-control" id="max_attempts_for_temp_ban"
							name="max_attempts_for_temp_ban" placeholder="<?= $this->translate->_('e.g., 3'); ?>"
							title="<?= $this->translate->_('Enter the number of failed attempts before a temporary ban'); ?>"
							value="<?php echo $this->max_attempts_for_temp_ban ?? 3; ?>" />
					</div>
					<div
						class="col-md-6 banTimer <?php echo (isset($this->enable_login_attempt_ban) && $this->enable_login_attempt_ban == "yes") ? "  " : "hide"; ?>">
						<label for="max_attempts_for_perm_ban"
							class="control-label"><?= $this->translate->_("Attempts Before Permanent Ban"); ?></label>
						<input type="number" class="form-control" id="max_attempts_for_perm_ban"
							name="max_attempts_for_perm_ban" placeholder="<?= $this->translate->_('e.g., 10'); ?>"
							title="<?= $this->translate->_('Enter the number of failed attempts before a permanent ban'); ?>"
							value="<?php echo $this->max_attempts_for_perm_ban ?? 10; ?>" />
					</div>
				</div>
			</div><br>

			<button type="button" class="collapsible active" data-toggle="collapse" data-target="#emailConfig"
				aria-expanded="true" aria-controls="collapseExample"><?= $this->translate->_("Email Settings"); ?> <b class="caret pull-right"
					style="text-align:right;"></b></button>
			<div class="collapse-content" id="emailConfig">
				<div class="alert alert-info" style="margin: 10px 0;">
					<i class="icon-info-sign"></i> <?= $this->translate->_("Email configuration is optional. You can configure it later when you have the email server details."); ?>
				</div>
				<div class="row">
					<div class="col-md-6">
						<label for="host" class="control-label"><?= $this->translate->_("SMTP Host"); ?></label>
						<input type="text" value="<?php echo $emailConfig->host ?? null; ?>" id="host"
							name="emailConfig[host]" class="form-control" style="background: #fff"
							placeholder="<?= $this->translate->_('e.g., smtp.gmail.com'); ?>"
							title="<?= $this->translate->_('Enter the SMTP server hostname'); ?>" />
					</div>
					<div class="col-md-6">
						<label for="port" class="control-label"><?= $this->translate->_("SMTP Port"); ?></label>
						<input type="text" value="<?php echo $emailConfig->port ?? null; ?>" id="port"
							name="emailConfig[port]" class="form-control isValidPort"
							placeholder="<?= $this->translate->_('e.g., 587 or 465'); ?>"
							title="<?= $this->translate->_('Enter the SMTP port (typically 587 or 465)'); ?>" />
					</div>
				</div>
				<div class="row">
					<div class="col-md-6">
						<label for="fromName" class="control-label"><?= $this->translate->_("From Name"); ?></label>
						<input type="text" value="<?php echo $emailConfig->fromName ?? null; ?>" id="fromName"
							name="emailConfig[fromName]" class="form-control" style="background: #fff"
							placeholder="<?= $this->translate->_('e.g., ePT System'); ?>" />
					</div>
					<div class="col-md-6">
						<label for="fromEmail" class="control-label"><?= $this->translate->_("From Email"); ?></label>
						<input type="text" value="<?php echo $emailConfig->fromEmail ?? null; ?>" id="fromEmail"
							name="emailConfig[fromEmail]" class="form-control" style="background: #fff"
							placeholder="<?= $this->translate->_('e.g., noreply@example.com'); ?>" />
					</div>
				</div>
				<div class="row">
					<div class="col-md-6">
						<label for="cc" class="control-label"><?= $this->translate->_("CC"); ?></label>
						<input type="text" value="<?php echo $emailConfig->cc ?? null; ?>" id="cc"
							name="emailConfig[cc]" class="form-control" style="background: #fff"
							placeholder="<?= $this->translate->_('Enter CC emails'); ?>" />
					</div>
					<div class="col-md-6">
						<label for="bcc" class="control-label"><?= $this->translate->_("BCC"); ?></label>
						<input type="text" value="<?php echo $emailConfig->bcc ?? null; ?>" id="bcc"
							name="emailConfig[bcc]" class="form-control" style="background: #fff"
							placeholder="<?= $this->translate->_('Enter BCC emails'); ?>" />
					</div>
				</div>
				<div class="row">
					<div class="col-md-6">
						<label for="ssl" class="control-label"><?= $this->translate->_("Encryption"); ?></label>
						<select class="form-control" id="ssl" name="emailConfig[ssl]" title="<?= $this->translate->_('Select the encryption type'); ?>">
							<option value="">-- <?= $this->translate->_("Select"); ?> --</option>
							<option value="tls" <?php echo (isset($emailConfig->ssl) && $emailConfig->ssl == 'tls') ? 'selected="selected"' : ""; ?>>TLS</option>
							<option value="ssl" <?php echo (isset($emailConfig->ssl) && $emailConfig->ssl == 'ssl') ? 'selected="selected"' : ""; ?>>SSL</option>
							<option value="starttls" <?php echo (isset($emailConfig->ssl) && $emailConfig->ssl == 'starttls') ? 'selected="selected"' : ""; ?>>STARTTLS</option>
							<option value="none" <?php echo (isset($emailConfig->ssl) && $emailConfig->ssl == 'none') ? 'selected="selected"' : ""; ?>><?= $this->translate->_("None"); ?></option>
						</select>
					</div>
					<div class="col-md-6">
						<label for="email" class="control-label"><?= $this->translate->_("Username"); ?></label>
						<input type="text" value="<?php echo $emailConfig->username ?? null; ?>" id="email"
							name="emailConfig[username]" class="form-control isEmail"
							style="background: #fff" placeholder="<?= $this->translate->_('Enter email address for authentication'); ?>"
							title="<?= $this->translate->_('Enter the email address used for SMTP authentication'); ?>" />
					</div>
				</div>
				<div class="row">
					<div class="col-md-6">
						<label for="password" class="control-label"><?= $this->translate->_("Password"); ?></label>
						<input type="password" value="<?php echo $emailConfig->password ?? null; ?>" id="password"
							name="emailConfig[password]" class="form-control" style="background: #fff"
							placeholder="<?= $this->translate->_('Enter SMTP password'); ?>" />
					</div>
					<div class="col-md-6">
						<label for="auth" class="control-label"><?= $this->translate->_("Authentication Type"); ?></label>
						<select class="form-control" id="auth" name="emailConfig[auth]" title="<?= $this->translate->_('Select the authentication method'); ?>">
							<option value="">-- <?= $this->translate->_("Select"); ?> --</option>
							<option value="login" <?php echo (isset($emailConfig->auth) && $emailConfig->auth == 'login') ? 'selected="selected"' : ""; ?>>Login</option>
							<option value="plain" <?php echo (isset($emailConfig->auth) && $emailConfig->auth == 'plain') ? 'selected="selected"' : ""; ?>>Plain</option>
							<option value="crammd5" <?php echo (isset($emailConfig->auth) && $emailConfig->auth == 'crammd5') ? 'selected="selected"' : ""; ?>>CRAM-MD5</option>
						</select>
					</div>
				</div>
			</div><br>

			<button type="button" class="collapsible active" data-toggle="collapse" data-target="#homeConfig"
				aria-expanded="true" aria-controls="collapseExample"><?= $this->translate->_("Home Page Settings"); ?> <b class="caret pull-right"
					style="text-align:right;"></b></button>
			<div class="collapse-content" id="homeConfig">
				<div class="alert alert-info" style="margin: 10px 0;">
					<i class="icon-info-sign"></i> <?= $this->translate->_("Home page customization is optional. Default values will be used if left empty."); ?>
				</div>

				<!-- Basic Settings -->
				<div class="row">
					<div class="col-md-6">
						<label for="homeTitle" class="control-label"><?= $this->translate->_("Page Title"); ?></label>
						<input type="text" value="<?php echo $home->title ?? null; ?>" id="homeTitle" name="home[title]"
							class="form-control"
							placeholder="<?= $this->translate->_('Enter the home page title'); ?>"
							title="<?= $this->translate->_('Enter the title displayed on the home page'); ?>" />
					</div>
					<div class="col-md-6">
						<label for="homeVideoUrl" class="control-label"><?= $this->translate->_("Video URL"); ?></label>
						<input type="text" value="<?php echo $home->videoUrl ?? null; ?>" id="homeVideoUrl" name="home[videoUrl]"
							class="form-control"
							placeholder="<?= $this->translate->_('e.g., https://youtube.com/watch?v=...'); ?>"
							title="<?= $this->translate->_('Enter a YouTube or video URL'); ?>" />
					</div>
				</div>
				<div class="row">
					<div class="col-md-6">
						<label for="homeAdditionalLink" class="control-label"><?= $this->translate->_("Additional Link URL"); ?></label>
						<input type="text" value="<?php echo $home->additionalLink ?? null; ?>" id="homeAdditionalLink" name="home[additionalLink]"
							class="form-control"
							placeholder="<?= $this->translate->_('e.g., https://example.com/more-info'); ?>"
							title="<?= $this->translate->_('Enter an additional link URL'); ?>" />
					</div>
					<div class="col-md-6">
						<label for="homeAdditionalLinkText" class="control-label"><?= $this->translate->_("Additional Link Text"); ?></label>
						<input type="text" value="<?php echo $home->additionalLinkText ?? null; ?>" id="homeAdditionalLinkText" name="home[additionalLinkText]"
							class="form-control"
							placeholder="<?= $this->translate->_('e.g., Learn More'); ?>"
							title="<?= $this->translate->_('Enter the text for the additional link'); ?>" />
					</div>
				</div>

				<!-- Feature Cards Section -->
				<h5>
					<i class="icon-th-large"></i> <?= $this->translate->_("Feature Cards"); ?>
				</h5>
				<p class="text-muted"><?= $this->translate->_("Configure up to 3 feature cards displayed on the home page. Each card has an icon, heading, and description."); ?></p>

				<!-- Feature Card 1 -->
				<div class="row feature-card-row">
					<div class="col-md-12">
						<label class="control-label" style="font-weight: 600; color: #4a6fa5;"><?= $this->translate->_("Feature Card 1"); ?></label>
					</div>
					<div class="col-md-3">
						<label for="homeIcon1" class="control-label"><?= $this->translate->_("Icon"); ?></label>
						<input type="text" value="<?php echo $home->icon1 ?? null; ?>" id="homeIcon1" name="home[icon1]"
							class="form-control"
							placeholder="<?= $this->translate->_('e.g., icon-beaker'); ?>"
							title="<?= $this->translate->_('Enter the icon class name'); ?>" />
					</div>
					<div class="col-md-4">
						<label for="homeHeading1" class="control-label"><?= $this->translate->_("Heading"); ?></label>
						<input type="text" value="<?php echo $home->heading1 ?? null; ?>" id="homeHeading1" name="home[heading1]"
							class="form-control"
							placeholder="<?= $this->translate->_('Enter heading text'); ?>"
							title="<?= $this->translate->_('Enter the heading for this feature card'); ?>" />
					</div>
					<div class="col-md-5">
						<label for="homeSubHeading1" class="control-label"><?= $this->translate->_("Description"); ?></label>
						<textarea id="homeSubHeading1" name="home[subHeading1]" class="form-control" rows="2"
							placeholder="<?= $this->translate->_('Enter description text'); ?>"
							title="<?= $this->translate->_('Enter the description for this feature card'); ?>"><?php echo $home->subHeading1 ?? null; ?></textarea>
					</div>
				</div>

				<!-- Feature Card 2 -->
				<div class="row feature-card-row">
					<div class="col-md-12">
						<label class="control-label" style="font-weight: 600; color: #4a6fa5;"><?= $this->translate->_("Feature Card 2"); ?></label>
					</div>
					<div class="col-md-3">
						<label for="homeIcon2" class="control-label"><?= $this->translate->_("Icon"); ?></label>
						<input type="text" value="<?php echo $home->icon2 ?? null; ?>" id="homeIcon2" name="home[icon2]"
							class="form-control"
							placeholder="<?= $this->translate->_('e.g., icon-group'); ?>"
							title="<?= $this->translate->_('Enter the icon class name'); ?>" />
					</div>
					<div class="col-md-4">
						<label for="homeHeading2" class="control-label"><?= $this->translate->_("Heading"); ?></label>
						<input type="text" value="<?php echo $home->heading2 ?? null; ?>" id="homeHeading2" name="home[heading2]"
							class="form-control"
							placeholder="<?= $this->translate->_('Enter heading text'); ?>"
							title="<?= $this->translate->_('Enter the heading for this feature card'); ?>" />
					</div>
					<div class="col-md-5">
						<label for="homeSubHeading2" class="control-label"><?= $this->translate->_("Description"); ?></label>
						<textarea id="homeSubHeading2" name="home[subHeading2]" class="form-control" rows="2"
							placeholder="<?= $this->translate->_('Enter description text'); ?>"
							title="<?= $this->translate->_('Enter the description for this feature card'); ?>"><?php echo $home->subHeading2 ?? null; ?></textarea>
					</div>
				</div>

				<!-- Feature Card 3 -->
				<div class="row feature-card-row">
					<div class="col-md-12">
						<label class="control-label" style="font-weight: 600; color: #4a6fa5;"><?= $this->translate->_("Feature Card 3"); ?></label>
					</div>
					<div class="col-md-3">
						<label for="homeIcon3" class="control-label"><?= $this->translate->_("Icon"); ?></label>
						<input type="text" value="<?php echo $home->icon3 ?? null; ?>" id="homeIcon3" name="home[icon3]"
							class="form-control"
							placeholder="<?= $this->translate->_('e.g., icon-bar-chart'); ?>"
							title="<?= $this->translate->_('Enter the icon class name'); ?>" />
					</div>
					<div class="col-md-4">
						<label for="homeHeading3" class="control-label"><?= $this->translate->_("Heading"); ?></label>
						<input type="text" value="<?php echo $home->heading3 ?? null; ?>" id="homeHeading3" name="home[heading3]"
							class="form-control"
							placeholder="<?= $this->translate->_('Enter heading text'); ?>"
							title="<?= $this->translate->_('Enter the heading for this feature card'); ?>" />
					</div>
					<div class="col-md-5">
						<label for="homeSubHeading3" class="control-label"><?= $this->translate->_("Description"); ?></label>
						<textarea id="homeSubHeading3" name="home[subHeading3]" class="form-control" rows="2"
							placeholder="<?= $this->translate->_('Enter description text'); ?>"
							title="<?= $this->translate->_('Enter the description for this feature card'); ?>"><?php echo $home->subHeading3 ?? null; ?></textarea>
					</div>
				</div>

				<!-- Home Page Logos -->
				<h5>
					<i class="icon-picture"></i> <?= $this->translate->_("Home Page Logos"); ?>
				</h5>
				<div class="row">
					<div class="col-md-6">
						<label for="home_left_logo" class="control-label"><?= $this->translate->_("Logo 1 (Left)"); ?></label>
						<div class="fileinput fileinput-new home_left_logo" data-provides="fileinput">
							<?php if (isset($this->home_left_logo) && trim($this->home_left_logo) != '' && file_exists(UPLOAD_PATH . DIRECTORY_SEPARATOR . 'logos' . DIRECTORY_SEPARATOR . $this->home_left_logo)) { ?>
								<img src="/uploads/logos/<?php echo $this->home_left_logo; ?>" alt="<?= $this->translate->_('Logo image'); ?>"
									class="home_left_logo_pic" style="width: 150px;">
								<a href="javascript:void(0);"
									onclick="deleteImg('home_left_logo', 'home_left_logo_pic', 'delete_home_left_logo', '<?= $this->home_left_logo; ?>');"
									class="mandatory home_left_logo_pic">x</a>
								<input class="readPage" type="file" id="home_left_logo" name="home_left_logo"
									title="<?= $this->translate->_('Select logo image'); ?>"
									accept="image/png, image/jpeg, image/gif" style="display: none;">
							<?php } else { ?>
								<input class="readPage" type="file" id="home_left_logo" name="home_left_logo"
									title="<?= $this->translate->_('Select logo image'); ?>"
									accept="image/png, image/jpeg, image/gif">
							<?php } ?>
						</div>
						<small class="text-muted"><?= $this->translate->_("Recommended size: 80x80 pixels"); ?></small>
					</div>
					<div class="col-md-6">
						<label for="home_right_logo" class="control-label"><?= $this->translate->_("Logo 2 (Right)"); ?></label>
						<div class="fileinput fileinput-new home_right_logo" data-provides="fileinput">
							<?php if (isset($this->home_right_logo) && trim($this->home_right_logo) != '' && file_exists(UPLOAD_PATH . DIRECTORY_SEPARATOR . 'logos' . DIRECTORY_SEPARATOR . $this->home_right_logo)) { ?>
								<img src="/uploads/logos/<?php echo $this->home_right_logo; ?>" alt="<?= $this->translate->_('Logo image'); ?>"
									class="home_right_logo_pic" style="width: 150px;">
								<a href="javascript:void(0);"
									onclick="deleteImg('home_right_logo', 'home_right_logo_pic', 'delete_home_right_logo', '<?php echo $this->home_right_logo; ?>');"
									class="mandatory home_right_logo_pic">x</a>
								<input class="readPage" type="file" id="home_right_logo" name="home_right_logo"
									title="<?= $this->translate->_('Select logo image'); ?>"
									style="display: none;" accept="image/png, image/jpeg, image/gif">
							<?php } else { ?>
								<input class="readPage" type="file" id="home_right_logo" name="home_right_logo"
									title="<?= $this->translate->_('Select logo image'); ?>"
									accept="image/png, image/jpeg, image/gif">
							<?php } ?>
						</div>
						<small class="text-muted"><?= $this->translate->_("Recommended size: 80x80 pixels"); ?></small>
					</div>
				</div>

				<!-- FAQ Section -->
				<h5 style="margin-top: 20px; border-bottom: 1px solid #ddd; padding-bottom: 10px;">
					<i class="icon-question-sign"></i> <?= $this->translate->_("Frequently Asked Questions (FAQ)"); ?>
				</h5>
				<p class="text-muted"><?= $this->translate->_("Add questions and answers to display on the home page FAQ section."); ?></p>
				<div class="row">
					<table style="width: 100%;" border="1" class="table table-bordered table-striped reftable clearfix"
						id="faqTable">
						<thead>
							<tr>
								<th style="text-align: center;vertical-align:middle;">
									<?= $this->translate->_("Question"); ?></th>
								<th style="text-align: center;vertical-align:middle;">
									<?= $this->translate->_("Answer"); ?></th>
								<th style="width:5%;text-align: center;vertical-align:middle;">
									<?= $this->translate->_("Actions"); ?></th>
							</tr>
						</thead>
						<tbody id="faqTableBody">
							<?php if (isset($faqResults) && !empty($faqResults)) {
								foreach ((array) $faqResults as $faq => $answer) { ?>
									<tr>
										<td>
											<textarea name="faqQuestions[]" class="form-control input-sm"
												placeholder="<?= $this->translate->_('Enter the question'); ?>"
												title="<?= $this->translate->_('Enter the FAQ question'); ?>"><?php echo $faq; ?></textarea>
										</td>
										<td>
											<textarea name="faqAnswers[]" class="form-control input-sm"
												placeholder="<?= $this->translate->_('Enter the answer'); ?>"
												title="<?= $this->translate->_('Enter the FAQ answer'); ?>"><?php echo $answer; ?></textarea>
										</td>
										<td>
											<a href="javascript:void(0);" onclick="addTbRow(this);"
												class="btn btn-xs btn-info" title="<?= $this->translate->_('Add row'); ?>"><i class="icon-plus"></i></a>&nbsp;&nbsp;<a
												href="javascript:void(0);" onclick="removeRow(this)"
												class="btn btn-xs btn-danger" title="<?= $this->translate->_('Remove row'); ?>"><i class="icon-minus"></i></a>
										</td>
									</tr>
								<?php }
							} else { ?>
								<tr>
									<td>
										<textarea name="faqQuestions[]" class="form-control input-sm"
											placeholder="<?= $this->translate->_('Enter the question'); ?>" title="<?= $this->translate->_('Enter the FAQ question'); ?>"></textarea>
									</td>
									<td>
										<textarea name="faqAnswers[]" class="form-control input-sm"
											placeholder="<?= $this->translate->_('Enter the answer'); ?>" title="<?= $this->translate->_('Enter the FAQ answer'); ?>"></textarea>
									</td>
									<td>
										<a href="javascript:void(0);" onclick="addTbRow(this);"
											class="btn btn-xs btn-info" title="<?= $this->translate->_('Add row'); ?>"><i class="icon-plus"></i></a>
									</td>
								</tr>
							<?php } ?>
						</tbody>
					</table>
				</div>
			</div><br>
		</fieldset>

		<div id="respond" style="margin: 0px auto 0px auto; text-align: center;" align="center">
			<input type="hidden" name="delete_home_right_logo" id="delete_home_right_logo">
			<input type="hidden" name="delete_home_left_logo" id="delete_home_left_logo">
			<input name="submitbtn" class="btn btn-primary" type="button" onclick="validateNow();return false;"
				tabindex="7" value="<?= $this->translate->_("Update"); ?>" />
			<input class="btn btn-danger" type="button" onclick="window.location.href='/admin/index';" tabindex="8"
				value="<?= $this->translate->_("Back"); ?>" />
		</div>

		<!-- Floating Action Buttons -->
		<div class="floating-buttons">
			<button type="button" class="btn btn-primary" onclick="validateNow();return false;">
				<i class="icon-ok"></i> <?= $this->translate->_("Update"); ?>
			</button>
			<button type="button" class="btn btn-danger" onclick="window.location.href='/admin/index';">
				<i class="icon-arrow-left"></i> <?= $this->translate->_("Back"); ?>
			</button>
		</div>
	</form>
</div>
<script type="text/javascript">
	// Existing functions...
	// Email validation helper function
	function isValidEmail(email) {
		var emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
		return emailRegex.test(email.trim());
	}

	// Validate comma-separated emails (optional - only validates format if provided)
	function validateEmails(emailString) {
		// Empty is allowed (optional field)
		if (!emailString || emailString.trim() === '') {
			return { valid: true };
		}
		var emails = emailString.split(',');
		var invalidEmails = [];
		for (var i = 0; i < emails.length; i++) {
			var email = emails[i].trim();
			if (email && !isValidEmail(email)) {
				invalidEmails.push(email);
			}
		}
		if (invalidEmails.length > 0) {
			return {
				valid: false,
				message: '<?= $this->translate->_("Invalid email address(es)"); ?>: ' + invalidEmails.join(', ')
			};
		}
		return { valid: true };
	}

	function validateNow() {
		if ($("#jobCompletionAlertStatus").val() != "yes") {
			$("#jobCompletionAlertMails").val("")
		} else {
			// Validate email addresses when Job Completion Alerts is enabled
			var emailValidation = validateEmails($("#jobCompletionAlertMails").val());
			if (!emailValidation.valid) {
				alert(emailValidation.message);
				$("#jobCompletionAlertMails").focus();
				return false;
			}
		}
		// Validate at least one scheme is selected
		if ($("#schemeId").val() == null || $("#schemeId").val().length == 0) {
			alert('<?= $this->translate->_("Please select at least one Active Scheme"); ?>');
			return false;
		}
		flag = deforayValidator.init({
			formId: 'globalConfigForm'
		});
		if (flag) {
			$.blockUI();
			document.getElementById('globalConfigForm').submit();
		}
	}

	$(document).ready(function() {
		// Collapsible functionality
		$('.collapsible').on('click', function() {
			$(this).toggleClass('active');
			var content = $(this).next('.collapse-content');
			if (content.is(':visible')) {
				content.slideUp();
			} else {
				content.slideDown();
			}
		});

		// Expand All functionality
		$('#expandAll').on('click', function() {
			$('.collapse-content').slideDown();
			$('.collapsible').addClass('active');
		});

		// Collapse All functionality
		$('#collapseAll').on('click', function() {
			$('.collapse-content').slideUp();
			$('.collapsible').removeClass('active');
		});

		// Jump to section functionality
		$('#jumpToSection').on('change', function() {
			var sectionId = $(this).val();
			if (sectionId) {
				// Open the selected section
				$('#' + sectionId).slideDown();
				$('.collapsible[data-target="#' + sectionId + '"]').addClass('active');

				// Scroll to section
				$('html, body').animate({
					scrollTop: $('#' + sectionId).offset().top - 100
				}, 500);
			}
		});

		// Search functionality
		$('#searchSettings').on('keyup', function() {
			var searchTerm = $(this).val().toLowerCase();

			if (searchTerm === '') {
				// Reset: hide all highlights and close sections
				$('.collapse-content').slideUp();
				$('.collapsible').removeClass('active');
				$('.search-highlight').removeClass('search-highlight');
				return;
			}

			// Search through all form fields
			$('.collapse-content').each(function() {
				var section = $(this);
				var hasMatch = false;

				section.find('label, input, textarea, select').each(function() {
					var text = $(this).text().toLowerCase() || $(this).attr('placeholder')?.toLowerCase() || '';

					if (text.includes(searchTerm)) {
						hasMatch = true;
						$(this).addClass('search-highlight');
					} else {
						$(this).removeClass('search-highlight');
					}
				});

				// Show section if it has matches
				if (hasMatch) {
					section.slideDown();
					section.prev('.collapsible').addClass('active');
				} else {
					section.slideUp();
					section.prev('.collapsible').removeClass('active');
				}
			});
		});

		// Initialize tom-select for scheme selection
		new TomSelect('#schemeId', {
			plugins: ['remove_button'],
			maxItems: null,
			placeholder: '<?= $this->translate->_("Select schemes..."); ?>',
			allowEmptyOption: false
		});

		$('#training_instance').on('change', function() {
			if ($(this).val() == 'no') {
				$('#training_instance_text').val('');
				$('.trainingText').hide();
			} else {
				$('.trainingText').show();
				if ($('#training_instance_text').val() == '') {
					$('#training_instance_text').val('TRAINING');
				}
			}
		});

		$('#training_instance').trigger('change');
		participantLoginBan();

		// Auto-populate domain from current URL (always update to match current server)
		$('#domain').val(window.location.origin);
	});

	// Add highlight style
	$('<style>.search-highlight { background-color: yellow !important; }</style>').appendTo('head');

	// Rest of existing functions...
	function deleteImg(show, hide, deletefile, file) {
		$('#' + show).show();
		$('.' + hide).hide();
		$('#' + deletefile).val(file);
	}

	function showMailBox(value) {
		if (value == "yes") {
			$(".mail-box").show();
		} else {
			$(".mail-box").hide();
		}
	}

	function participantLoginBan() {
		value = $('#enable_login_attempt_ban').val();
		if (value == "yes") {
			$('.banTimer').removeClass('hide');
		} else {
			$('.banTimer').addClass('hide');
		}
	}

	function toggleRadios(obj) {
		var sel = $(obj).data('title');
		var tog = $(obj).data('toggle');
		$('#' + tog).prop('value', sel);

		$('a[data-toggle="' + tog + '"]').not('[data-title="' + sel + '"]').removeClass('active').addClass('notActive');
		$('a[data-toggle="' + tog + '"][data-title="' + sel + '"]').removeClass('notActive').addClass('active');
	}

	function addTbRow(obj) {
		let html = '<tr>\
			<td>\
				<textarea name="faqQuestions[]" class="form-control input-sm" placeholder="<?= $this->translate->_("Enter the question"); ?>" title="<?= $this->translate->_("Enter the FAQ question"); ?>"></textarea>\
			</td>\
			<td>\
				<textarea name="faqAnswers[]" class="form-control input-sm" placeholder="<?= $this->translate->_("Enter the answer"); ?>" title="<?= $this->translate->_("Enter the FAQ answer"); ?>"></textarea>\
			</td>\
			<td>\
				<a href="javascript:void(0);" onclick="addTbRow(this);" class="btn btn-xs btn-info" title="<?= $this->translate->_("Add row"); ?>"><i class="icon-plus"></i></a>\
				&nbsp;&nbsp;<a href="javascript:void(0);" onclick="removeRow(this)" class="btn btn-xs btn-danger" title="<?= $this->translate->_("Remove row"); ?>"><i class="icon-minus"></i></a>\
			</td>\
		</tr>';
		$(obj.parentNode.parentNode).after(html);
	}

	function removeRow(obj) {
		$(obj.parentNode.parentNode).fadeOut("normal", function() {
			$(this).remove();
		});
	}
</script>